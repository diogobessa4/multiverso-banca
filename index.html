<!DOCTYPE html>
<html lang="pt-BR">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Multiverso ‚Äî Banca Geek</title>
<script src="https://www.gstatic.com/firebasejs/9.22.0/firebase-app-compat.js"></script>
<script src="https://www.gstatic.com/firebasejs/9.22.0/firebase-firestore-compat.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/react/18.2.0/umd/react.production.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/react-dom/18.2.0/umd/react-dom.production.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/babel-standalone/7.23.2/babel.min.js"></script>
<link href="https://fonts.googleapis.com/css2?family=Bebas+Neue&family=Rajdhani:wght@400;600;700&family=Space+Mono&display=swap" rel="stylesheet">

<!-- ‚ïî‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïó
     ‚ïë  CONFIGURA√á√ÉO FIREBASE ‚Äî COLE SEUS DADOS AQUI          ‚ïë
     ‚ïë  Substitua cada valor entre aspas pelo valor real       ‚ïë
     ‚ïë  que voc√™ copiou do Console do Firebase.                ‚ïë
     ‚ïö‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïù -->
<script>
(function() {
  try {
    var firebaseConfig = {
      apiKey:            "AIzaSyCO3FVw7ydaqr0_2N9AlB9rYj9UTkXtlGQ",
      authDomain:        "multiverso-banca.firebaseapp.com",
      projectId:         "multiverso-banca",
      storageBucket:     "multiverso-banca.firebasestorage.app",
      messagingSenderId: "15821286059",
      appId:             "1:15821286059:web:385ffd2162ad55e005e5ee"
    };

    // Verifica se as credenciais foram preenchidas
    var notConfigured = Object.values(firebaseConfig).some(function(v) {
      return !v || v.indexOf("COLE_AQUI") !== -1 || v.trim() === "";
    });

    window.__FB_CONFIGURED__ = !notConfigured;

    if (!notConfigured) {
      firebase.initializeApp(firebaseConfig);
      window.db = firebase.firestore();
    }
  } catch(e) {
    window.__FB_CONFIGURED__ = false;
    window.__FB_ERROR__ = e.message;
    console.error("Firebase init error:", e);
  }
})();
</script>

<style>
*,*::before,*::after{box-sizing:border-box;margin:0;padding:0}
:root{
  --void:#08090d;--deep:#0d0e1a;--panel:#111322;--card:#161828;
  --accent:#ff3c5f;--neon:#00e5ff;--gold:#ffd600;--green:#4ade80;--purple:#b388ff;--orange:#ff8a65;
  --text:#e8eaf0;--muted:#5a6278;
  --border:rgba(0,229,255,.10);--border-hot:rgba(255,60,95,.25);
}
/* ‚îÄ‚îÄ TEMA CLARO ‚îÄ‚îÄ */
body[data-theme="light"]{
  --void:#f0f2fa;--deep:#e4e8f5;--panel:#ffffff;--card:#f5f7ff;
  --accent:#d4163c;--neon:#0055cc;--gold:#b36a00;--green:#166534;--purple:#6d28d9;--orange:#c2410c;
  --text:#0f1120;--muted:#4b5563;
  --border:rgba(0,80,200,.13);--border-hot:rgba(210,0,50,.2);
}
body[data-theme="light"] ::-webkit-scrollbar-thumb{background:#d4163c}
body[data-theme="light"] .nav{background:rgba(240,242,250,.97)}
body[data-theme="light"] select option{background:#fff;color:#0f1120}
body[data-theme="light"] .logo{background:linear-gradient(135deg,#0055cc,#d4163c);-webkit-background-clip:text;-webkit-text-fill-color:transparent;background-clip:text}
body[data-theme="light"] .logo-gold{-webkit-text-fill-color:#b36a00}
body[data-theme="light"] .nav-tab{color:#4b5563;border-color:rgba(0,80,200,.15)}
body[data-theme="light"] .nav-tab:hover{color:#0055cc;border-color:rgba(0,80,200,.4)}
body[data-theme="light"] .nav-tab.active{color:#0055cc;border-color:#0055cc;background:rgba(0,85,204,.08)}
body[data-theme="light"] .btn-ghost{color:#0055cc;border-color:rgba(0,85,204,.4)}
body[data-theme="light"] .btn-ghost:hover{background:rgba(0,85,204,.07)}
body[data-theme="light"] .btn-neon{color:#0055cc;border-color:#0055cc}
body[data-theme="light"] .btn-neon:hover{background:rgba(0,85,204,.08)}
body[data-theme="light"] .marquee-bar{background:linear-gradient(90deg,#d4163c,#9b0d2a)}
body[data-theme="light"] .line-neon{background:linear-gradient(90deg,#0055cc,#b36a00);-webkit-background-clip:text;-webkit-text-fill-color:transparent;background-clip:text}
body[data-theme="light"] .hero-tag{color:#0055cc}
body[data-theme="light"] .comic-bg{background-image:linear-gradient(rgba(0,80,200,.04) 1px,transparent 1px),linear-gradient(90deg,rgba(0,80,200,.04) 1px,transparent 1px)}
body[data-theme="light"] .section-tag{color:#0055cc}
body[data-theme="light"] .product-price{color:#0055cc}
body[data-theme="light"] .modal-box{background:#fff}
body[data-theme="light"] .form-panel{background:#f5f7ff;border-color:rgba(0,85,204,.2);border-top-color:#0055cc}
body[data-theme="light"] .form-title{color:#0055cc}
body[data-theme="light"] .field-input{background:#eef0f8;border-color:rgba(0,80,200,.15);color:#0f1120}
body[data-theme="light"] .field-input:focus{border-color:#0055cc;box-shadow:0 0 0 3px rgba(0,85,204,.08)}
body[data-theme="light"] .contacts-box{background:#eef0f8;color:#0f1120}
body[data-theme="light"] input[type=date]::-webkit-calendar-picker-indicator{filter:none}
/* ‚îÄ‚îÄ TEMA ACESSIBILIDADE ‚îÄ‚îÄ */
body[data-theme="access"]{
  --void:#000;--deep:#0d0d0d;--panel:#1a1a1a;--card:#222;
  --accent:#ff6600;--neon:#ffff00;--gold:#fff;--green:#00ff88;--purple:#ff88ff;--orange:#ff8844;
  --text:#fff;--muted:#bbb;
  --border:rgba(255,255,255,.25);--border-hot:rgba(255,100,0,.5);
}
body[data-theme="access"] *{animation-duration:0.001s!important;transition-duration:0.05s!important}
body[data-theme="access"] .logo{background:none;-webkit-text-fill-color:#ffff00}
body[data-theme="access"] .logo-gold{-webkit-text-fill-color:#ff6600}
body[data-theme="access"] .line-neon{background:none;-webkit-text-fill-color:#ffff00}
body[data-theme="access"] .hero-tag{color:#ffff00}
body[data-theme="access"] .section-tag{color:#ffff00;font-size:.72rem}
body[data-theme="access"] .product-price{color:#ffff00;font-size:1.9rem}
body[data-theme="access"] .nav-tab{font-size:.68rem;border-width:2px}
body[data-theme="access"] .nav-tab.active{color:#000;background:#ffff00;border-color:#ffff00}
body[data-theme="access"] .nav-tab:hover{color:#ffff00;border-color:#ffff00}
body[data-theme="access"] .btn-primary{clip-path:none;font-size:1.1rem;border:2px solid #ff6600}
body[data-theme="access"] .btn-ghost{color:#ffff00;border-color:#ffff00;border-width:2px;font-size:.72rem}
body[data-theme="access"] .btn-neon{color:#ffff00;border-color:#ffff00;border-width:2px}
body[data-theme="access"] .marquee-bar{background:#ff6600}
body[data-theme="access"] .product-card{border-width:2px}
body[data-theme="access"] .product-card:hover{border-color:#ffff00;transform:none;box-shadow:0 0 0 3px #ffff00}
body[data-theme="access"] .badge{border-width:2px;font-size:.65rem;padding:4px 10px}
body[data-theme="access"] .field-input{border-width:2px;font-size:1.05rem}
body[data-theme="access"] .field-input:focus{border-color:#ffff00;box-shadow:0 0 0 4px rgba(255,255,0,.25)}
body[data-theme="access"] .field-label{font-size:.7rem;color:#bbb}
body[data-theme="access"] .modal-box{border-width:3px;border-top-width:4px;border-top-color:#ffff00}
body[data-theme="access"] .form-panel{border-width:2px;border-top-color:#ffff00}
body[data-theme="access"] .form-title{color:#ffff00;font-size:1.6rem}
body[data-theme="access"] .launch-item{border-left-width:4px}
body[data-theme="access"] .product-name{font-size:1.05rem}
body[data-theme="access"] .stat-num{font-size:3rem}
body[data-theme="access"] *:focus-visible{outline:3px solid #ffff00!important;outline-offset:3px!important}

html{scroll-behavior:smooth}
body{background:var(--void);color:var(--text);font-family:'Rajdhani',sans-serif;overflow-x:hidden;-webkit-font-smoothing:antialiased}
::-webkit-scrollbar{width:3px}::-webkit-scrollbar-track{background:var(--void)}::-webkit-scrollbar-thumb{background:var(--accent)}
select option{background:var(--panel)}
input[type=date]::-webkit-calendar-picker-indicator{filter:invert(.6);cursor:pointer}
@keyframes fadeUp{from{opacity:0;transform:translateY(16px)}to{opacity:1;transform:translateY(0)}}
@keyframes fadeIn{from{opacity:0}to{opacity:1}}
@keyframes glow{0%,100%{opacity:.5}50%{opacity:1}}
@keyframes marquee{from{transform:translateX(0)}to{transform:translateX(-50%)}}
@keyframes panelIn{from{opacity:0;transform:scale(.97)}to{opacity:1;transform:scale(1)}}
@keyframes toastIn{from{opacity:0;transform:translateY(12px) scale(.95)}to{opacity:1;transform:translateY(0) scale(1)}}
@keyframes modalIn{from{opacity:0;transform:translateY(20px) scale(.97)}to{opacity:1;transform:translateY(0) scale(1)}}
@keyframes spin{from{transform:rotate(0deg)}to{transform:rotate(360deg)}}

.nav{position:fixed;top:0;left:0;right:0;z-index:100;display:flex;align-items:center;justify-content:space-between;padding:0 24px;height:60px;background:rgba(8,9,13,.95);border-bottom:1px solid var(--border);backdrop-filter:blur(16px)}
.logo{font-family:'Bebas Neue',sans-serif;font-size:1.7rem;letter-spacing:4px;background:linear-gradient(135deg,var(--neon) 30%,var(--accent));-webkit-background-clip:text;-webkit-text-fill-color:transparent;background-clip:text;cursor:pointer;user-select:none}
.logo-gold{-webkit-text-fill-color:var(--gold)}
.nav-tab{font-family:'Space Mono',monospace;font-size:.6rem;letter-spacing:2px;padding:7px 14px;border:1px solid var(--border);background:transparent;color:var(--muted);cursor:pointer;text-transform:uppercase;transition:all .2s;white-space:nowrap;position:relative}
.nav-tab:hover{color:var(--neon);border-color:rgba(0,229,255,.3)}
.nav-tab.active{color:var(--neon);border-color:var(--neon);background:rgba(0,229,255,.08)}
.nav-badge{position:absolute;top:-5px;right:-5px;background:var(--accent);color:#fff;border-radius:50%;width:16px;height:16px;font-size:.5rem;display:flex;align-items:center;justify-content:center;font-family:monospace}

.btn-primary{background:var(--accent);color:#fff;border:none;padding:12px 28px;font-family:'Bebas Neue',sans-serif;font-size:1.05rem;letter-spacing:3px;cursor:pointer;clip-path:polygon(10px 0%,100% 0%,calc(100% - 10px) 100%,0% 100%);transition:all .18s;text-decoration:none;display:inline-block}
.btn-primary:hover{background:#e02d4f;transform:translateY(-1px);box-shadow:0 6px 24px rgba(255,60,95,.35)}
.btn-primary:active{transform:scale(.96)}
.btn-primary:disabled{opacity:.5;cursor:not-allowed;transform:none}
.btn-ghost{background:transparent;color:var(--neon);border:1px solid rgba(0,229,255,.4);padding:11px 24px;font-family:'Space Mono',monospace;font-size:.65rem;letter-spacing:2px;cursor:pointer;text-transform:uppercase;transition:all .18s;text-decoration:none;display:inline-block}
.btn-ghost:hover{background:rgba(0,229,255,.08);border-color:var(--neon)}
.btn-ghost:active{transform:scale(.96)}
.btn-neon{background:transparent;color:var(--neon);border:1px solid var(--neon);padding:8px 16px;font-family:'Space Mono',monospace;font-size:.6rem;letter-spacing:2px;cursor:pointer;text-transform:uppercase;transition:all .18s;white-space:nowrap}
.btn-neon:hover{background:rgba(0,229,255,.1)}
.btn-neon:active{transform:scale(.96)}
.btn-danger{background:transparent;color:var(--accent);border:1px solid var(--border-hot);padding:6px 12px;font-family:'Space Mono',monospace;font-size:.6rem;cursor:pointer;transition:all .18s}
.btn-danger:hover{background:rgba(255,60,95,.1)}
.btn-whatsapp{background:#25D366;color:#fff;border:none;padding:8px 16px;font-family:'Bebas Neue',sans-serif;font-size:.9rem;letter-spacing:2px;cursor:pointer;transition:all .18s;display:inline-flex;align-items:center;gap:6px}
.btn-whatsapp:hover{background:#1ebe5a;transform:translateY(-1px)}
.btn-sm{background:transparent;color:var(--neon);border:1px solid rgba(0,229,255,.3);padding:5px 10px;font-size:.72rem;cursor:pointer;transition:all .18s}
.btn-sm:hover{background:rgba(0,229,255,.1)}
.btn-stock{background:var(--panel);border:1px solid var(--border);color:var(--text);width:28px;height:28px;cursor:pointer;font-size:1rem;font-weight:bold;transition:all .15s;display:flex;align-items:center;justify-content:center;flex-shrink:0;line-height:1}
.btn-stock:hover{border-color:var(--neon);color:var(--neon);background:rgba(0,229,255,.08)}
.btn-stock:active{transform:scale(.88)}
.btn-stock:disabled{opacity:.3;cursor:not-allowed}

.field-label{font-family:'Space Mono',monospace;font-size:.58rem;color:var(--muted);letter-spacing:2px;text-transform:uppercase;margin-bottom:5px;display:block}
.field-input{background:var(--deep);border:1px solid var(--border);color:var(--text);padding:11px 14px;font-family:'Rajdhani',sans-serif;font-size:1rem;font-weight:500;width:100%;outline:none;transition:border-color .2s,box-shadow .2s;margin-bottom:12px}
.field-input:focus{border-color:var(--neon);box-shadow:0 0 0 3px rgba(0,229,255,.07)}
.field-input::placeholder{color:var(--muted)}

.section{padding:72px 24px}
.s-container{max-width:940px;margin:0 auto}
.section-tag{font-family:'Space Mono',monospace;font-size:.58rem;color:var(--neon);letter-spacing:3px;text-transform:uppercase;margin-bottom:8px}
.section-title{font-family:'Bebas Neue',sans-serif;font-size:clamp(1.8rem,4vw,2.8rem);letter-spacing:2px;line-height:1}
.section-head{display:flex;align-items:flex-end;justify-content:space-between;margin-bottom:28px;padding-bottom:16px;border-bottom:1px solid var(--border);flex-wrap:wrap;gap:12px}

.hero{min-height:100svh;display:flex;flex-direction:column;align-items:center;justify-content:center;text-align:center;padding:80px 24px 60px;position:relative;overflow:hidden}
.comic-bg{position:absolute;inset:0;background-image:linear-gradient(rgba(0,229,255,.025) 1px,transparent 1px),linear-gradient(90deg,rgba(0,229,255,.025) 1px,transparent 1px);background-size:48px 48px;pointer-events:none}
.hero-glow{position:absolute;border-radius:50%;pointer-events:none}
.hero-glow-1{width:500px;height:500px;background:radial-gradient(circle,rgba(255,60,95,.12) 0%,transparent 70%);top:-100px;left:-100px;animation:glow 4s ease-in-out infinite}
.hero-glow-2{width:600px;height:600px;background:radial-gradient(circle,rgba(0,229,255,.08) 0%,transparent 70%);bottom:-150px;right:-150px;animation:glow 5s ease-in-out infinite reverse}
.hero-tag{font-family:'Space Mono',monospace;font-size:.65rem;color:var(--neon);letter-spacing:5px;text-transform:uppercase;margin-bottom:20px;display:flex;align-items:center;gap:10px;animation:fadeUp .6s ease both}
.hero-tag::before,.hero-tag::after{content:'';width:32px;height:1px;background:var(--neon);opacity:.5}
.hero h1{font-family:'Bebas Neue',sans-serif;font-size:clamp(4.5rem,14vw,9rem);line-height:.88;letter-spacing:3px;margin-bottom:24px;animation:fadeUp .6s ease .1s both}
.line-neon{display:block;background:linear-gradient(90deg,var(--neon),var(--gold));-webkit-background-clip:text;-webkit-text-fill-color:transparent;background-clip:text}
.hero-desc{max-width:420px;font-size:1.05rem;color:var(--muted);line-height:1.7;margin-bottom:36px;animation:fadeUp .6s ease .2s both}
.hero-actions{display:flex;gap:12px;flex-wrap:wrap;justify-content:center;animation:fadeUp .6s ease .3s both}

.marquee-bar{background:linear-gradient(90deg,var(--accent),#c8213d);padding:11px 0;overflow:hidden;white-space:nowrap}
.marquee-track{display:inline-flex;animation:marquee 22s linear infinite}
.marquee-item{font-family:'Bebas Neue',sans-serif;font-size:.95rem;letter-spacing:4px;padding:0 32px;opacity:.9}
.marquee-dot{color:rgba(255,255,255,.4);padding:0 4px}

.badge{display:inline-flex;align-items:center;gap:5px;padding:3px 9px;font-family:'Space Mono',monospace;font-size:.55rem;letter-spacing:1px;border:1px solid;border-radius:2px}
.badge-dot{width:5px;height:5px;border-radius:50%;background:currentColor;animation:glow 2s ease-in-out infinite}

.catalog-grid{display:grid;grid-template-columns:repeat(auto-fill,minmax(180px,1fr));gap:2px}
.product-card{background:var(--panel);border:1px solid var(--border);overflow:hidden;transition:all .25s;cursor:pointer;position:relative}
.product-card:hover{border-color:rgba(0,229,255,.35);transform:translateY(-3px);box-shadow:0 12px 40px rgba(0,0,0,.4)}
.product-thumb{height:190px;overflow:hidden;position:relative;display:flex;align-items:center;justify-content:center}
.product-thumb img{width:100%;height:100%;object-fit:cover;display:block;transition:transform .4s}
.product-card:hover .product-thumb img{transform:scale(1.06)}
.product-placeholder{width:100%;height:100%;display:flex;flex-direction:column;align-items:center;justify-content:center;gap:10px;position:relative;overflow:hidden}
.placeholder-cat{font-family:'Bebas Neue',sans-serif;font-size:3.5rem;letter-spacing:2px;color:rgba(255,255,255,.06);position:absolute;bottom:-8px;left:0;right:0;text-align:center;line-height:1}
.placeholder-icon{font-size:2rem;opacity:.2;position:relative;z-index:1}
.placeholder-label{font-family:'Space Mono',monospace;font-size:.55rem;letter-spacing:2px;color:rgba(255,255,255,.18);text-transform:uppercase;position:relative;z-index:1}
.stock-bar-wrap{height:2px;background:rgba(255,255,255,.05);margin:10px 0 6px;border-radius:1px;overflow:hidden}
.stock-bar{height:100%;border-radius:1px;transition:width .5s ease}
.product-info{padding:14px 16px 16px}
.product-cat{font-family:'Space Mono',monospace;font-size:.55rem;color:var(--muted);letter-spacing:2px;text-transform:uppercase;margin-bottom:5px}
.product-name{font-weight:700;font-size:.98rem;line-height:1.3;margin-bottom:12px}
.product-footer{display:flex;align-items:center;justify-content:space-between}
.product-price{font-family:'Bebas Neue',sans-serif;font-size:1.6rem;color:var(--neon);letter-spacing:1px;line-height:1}
.wish-badge{position:absolute;top:8px;right:8px;background:rgba(0,0,0,.75);border:1px solid var(--gold);color:var(--gold);font-family:'Space Mono',monospace;font-size:.52rem;padding:2px 7px;letter-spacing:1px}

.launch-item{background:var(--panel);border:1px solid var(--border);border-left:3px solid var(--accent);padding:16px 20px;display:flex;align-items:center;gap:20px;margin-bottom:2px;transition:all .2s}
.launch-item:hover{background:var(--card);box-shadow:0 4px 20px rgba(0,0,0,.3)}

.features-grid{display:grid;grid-template-columns:repeat(auto-fit,minmax(200px,1fr));gap:2px}
.feature-card{background:var(--panel);padding:32px 28px;position:relative;overflow:hidden;transition:background .2s}
.feature-card:hover{background:rgba(0,229,255,.03)}
.feature-card::after{content:'';position:absolute;bottom:0;left:0;right:0;height:2px;background:linear-gradient(90deg,var(--accent),var(--neon));transform:scaleX(0);transform-origin:left;transition:transform .3s}
.feature-card:hover::after{transform:scaleX(1)}
.feature-num{position:absolute;top:16px;right:20px;font-family:'Bebas Neue',sans-serif;font-size:4.5rem;color:rgba(255,255,255,.025);line-height:1;user-select:none}
.feature-icon{font-size:2rem;margin-bottom:18px;display:block}
.feature-title{font-family:'Bebas Neue',sans-serif;font-size:1.4rem;letter-spacing:2px;margin-bottom:10px}
.feature-desc{font-size:.92rem;color:var(--muted);line-height:1.65}

.modal-overlay{position:fixed;inset:0;background:rgba(0,0,0,.88);z-index:200;display:flex;align-items:center;justify-content:center;padding:20px;animation:fadeIn .2s ease}
.modal-box{background:var(--panel);border:1px solid var(--border);border-top:3px solid var(--neon);max-width:500px;width:100%;max-height:90svh;overflow-y:auto;animation:modalIn .25s ease;position:relative}
.modal-header{padding:22px 24px 0;display:flex;align-items:flex-start;justify-content:space-between;gap:16px}
.modal-body{padding:20px 24px 24px}
.modal-close{background:none;border:1px solid var(--border);color:var(--muted);width:30px;height:30px;cursor:pointer;font-size:1rem;transition:all .2s;flex-shrink:0;line-height:1}
.modal-close:hover{border-color:var(--accent);color:var(--accent)}
.modal-tabs{display:flex;gap:2px;margin:16px 0 0}
.modal-tab{flex:1;padding:9px;font-family:'Space Mono',monospace;font-size:.6rem;letter-spacing:1px;border:1px solid var(--border);background:transparent;color:var(--muted);cursor:pointer;text-transform:uppercase;transition:all .2s}
.modal-tab.active{color:var(--neon);border-color:var(--neon);background:rgba(0,229,255,.08)}

.form-panel{background:var(--card);border:1px solid rgba(0,229,255,.2);border-top:2px solid var(--neon);padding:28px;margin-bottom:16px;animation:panelIn .25s ease}
.form-title{font-family:'Bebas Neue',sans-serif;font-size:1.4rem;letter-spacing:3px;color:var(--neon);margin-bottom:22px}
.form-grid{display:grid;grid-template-columns:1fr 1fr;gap:14px}
.col-full{grid-column:1/-1}

.stats-row{display:flex;gap:2px;margin-bottom:32px;flex-wrap:wrap}
.stat-card{background:var(--panel);border:1px solid var(--border);border-top:2px solid;padding:22px 20px;flex:1;min-width:120px;transition:transform .2s}
.stat-card:hover{transform:translateY(-2px)}
.stat-num{font-family:'Bebas Neue',sans-serif;font-size:2.8rem;line-height:1;letter-spacing:2px}
.stat-label{font-family:'Space Mono',monospace;font-size:.58rem;color:var(--muted);letter-spacing:2px;margin-top:6px;text-transform:uppercase}

.product-row{background:var(--panel);border:1px solid rgba(255,255,255,.04);padding:10px 14px;display:flex;align-items:center;gap:12px;margin-bottom:2px;transition:all .2s}
.product-row:hover{background:var(--card);border-color:var(--border)}
.thumb-sm{width:52px;height:52px;overflow:hidden;flex-shrink:0;border:1px solid var(--border);display:flex;align-items:center;justify-content:center;font-family:'Bebas Neue',sans-serif;font-size:1.1rem;color:rgba(255,255,255,.12)}
.thumb-sm img{width:100%;height:100%;object-fit:cover;display:block}
.stock-controls{display:flex;align-items:center;gap:4px;flex-shrink:0}
.stock-val{font-family:'Bebas Neue',sans-serif;font-size:1.3rem;min-width:26px;text-align:center;line-height:1}

.reservation-card{background:var(--panel);border:1px solid var(--border);border-left:3px solid var(--gold);padding:16px 18px;margin-bottom:2px;transition:background .2s}
.reservation-card:hover{background:var(--card)}
.res-status{display:inline-flex;align-items:center;gap:4px;padding:2px 8px;font-family:'Space Mono',monospace;font-size:.52rem;letter-spacing:1px;border:1px solid;border-radius:2px}

.report-bar-row{display:flex;align-items:center;gap:12px;margin-bottom:10px}
.report-bar-bg{flex:1;height:6px;background:rgba(255,255,255,.05);border-radius:3px;overflow:hidden}
.report-bar-fill{height:100%;border-radius:3px;transition:width .6s ease}
.report-label{font-family:'Space Mono',monospace;font-size:.6rem;color:var(--muted);min-width:110px}
.report-count{font-family:'Bebas Neue',sans-serif;font-size:1.1rem;color:var(--neon);min-width:24px;text-align:right}

.log-item{display:flex;align-items:flex-start;gap:12px;padding:10px 0;border-bottom:1px solid rgba(255,255,255,.04)}
.log-dot{width:8px;height:8px;border-radius:50%;margin-top:5px;flex-shrink:0}

.img-picker{background:var(--deep);border:1px solid var(--border);padding:18px}
.img-preview{width:88px;height:88px;background:var(--void);border:1px solid var(--border);overflow:hidden;flex-shrink:0;display:flex;align-items:center;justify-content:center;font-size:1.8rem;opacity:.35}
.img-preview.has-image{opacity:1}
.img-preview img{width:100%;height:100%;object-fit:cover}

.cam-modal{position:fixed;inset:0;background:rgba(0,0,0,.96);z-index:300;display:flex;flex-direction:column;align-items:center;justify-content:center;gap:20px;animation:fadeIn .2s ease;padding:24px}
.cam-viewfinder{position:relative;width:min(360px,90vw);aspect-ratio:1/1;border:2px solid var(--neon);overflow:hidden;background:#000}
.cam-viewfinder video{width:100%;height:100%;object-fit:cover;display:block}
.cam-corner{position:absolute;width:24px;height:24px}
.tl{top:0;left:0;border-top:2px solid var(--accent);border-left:2px solid var(--accent)}
.tr{top:0;right:0;border-top:2px solid var(--accent);border-right:2px solid var(--accent)}
.bl{bottom:0;left:0;border-bottom:2px solid var(--accent);border-left:2px solid var(--accent)}
.br{bottom:0;right:0;border-bottom:2px solid var(--accent);border-right:2px solid var(--accent)}

.toast{position:fixed;bottom:28px;right:20px;color:#08090d;padding:12px 20px;font-family:'Space Mono',monospace;font-size:.72rem;letter-spacing:1px;font-weight:bold;z-index:500;box-shadow:0 8px 32px rgba(0,0,0,.3);animation:toastIn .3s cubic-bezier(.34,1.56,.64,1);max-width:calc(100vw - 40px)}

/* sync dot */
.sync-dot{width:7px;height:7px;border-radius:50%;background:var(--green);display:inline-block;animation:glow 2s infinite}
.sync-dot.offline{background:var(--accent);animation:none}

.admin-subnav{background:var(--deep);border-bottom:1px solid var(--border);padding:10px 20px;display:flex;align-items:center;justify-content:space-between;gap:8px;flex-wrap:wrap}
.admin-tabs{display:flex;gap:4px;flex-wrap:wrap}
.login-card{background:var(--panel);border:1px solid var(--border);border-top:3px solid var(--accent);padding:44px 36px;width:100%;max-width:360px;box-shadow:0 24px 80px rgba(0,0,0,.5)}
.notify-section{background:linear-gradient(135deg,var(--deep) 0%,rgba(255,60,95,.04) 50%,var(--deep) 100%);border-top:1px solid var(--border);border-bottom:1px solid var(--border);text-align:center}
footer{background:var(--deep);border-top:1px solid var(--border);padding:40px 24px 24px;text-align:center}
.empty{text-align:center;padding:64px 0;color:var(--muted);font-family:'Space Mono',monospace;font-size:.75rem;letter-spacing:1px;line-height:2}
.empty-icon{font-size:2.5rem;display:block;margin-bottom:12px;opacity:.25}
.sub-row{background:var(--panel);border:1px solid var(--border);padding:14px 18px;display:flex;align-items:center;gap:14px;margin-bottom:2px;transition:background .2s}
.sub-row:hover{background:var(--card)}
.contacts-box{background:var(--deep);border:1px solid var(--border);padding:14px 16px;margin-top:10px;font-family:'Space Mono',monospace;font-size:.72rem;color:var(--text);word-break:break-all;line-height:1.9;user-select:all;white-space:pre-wrap}

/* loading screen */
.loading-screen{position:fixed;inset:0;background:var(--void);z-index:999;display:flex;flex-direction:column;align-items:center;justify-content:center;gap:20px}
.spinner{width:40px;height:40px;border:3px solid var(--border);border-top-color:var(--neon);border-radius:50%;animation:spin 0.8s linear infinite}

@media(max-width:640px){
  .nav{padding:0 16px;height:56px}
  .logo{font-size:1.4rem}
  .nav-tab{padding:6px 9px;font-size:.52rem;letter-spacing:1px}
  .hero h1{font-size:clamp(3.2rem,16vw,5rem)}
  .section{padding:48px 16px}
  .launch-item{flex-wrap:wrap;gap:12px}
  .form-grid{grid-template-columns:1fr}
  .col-full{grid-column:1}
  .hero-actions{flex-direction:column;width:100%}
  .hero-actions .btn-primary,.hero-actions .btn-ghost{width:100%;text-align:center;clip-path:none}
  .stats-row{gap:4px}
  .stat-card{min-width:100px;padding:14px 12px}
  .stat-num{font-size:2rem}
  .catalog-grid{grid-template-columns:repeat(auto-fill,minmax(155px,1fr))}
  .features-grid{grid-template-columns:1fr}
  .section-head{flex-direction:column;align-items:flex-start}
  .login-card{padding:32px 20px}
  .admin-tabs{gap:2px}
  .admin-tabs .nav-tab{font-size:.5rem;padding:6px 8px;letter-spacing:.5px}
}
@media(max-width:420px){
  .catalog-grid{grid-template-columns:1fr 1fr}
  .product-thumb{height:155px}
}
</style>
</head>
<body>
<div id="root"></div>
<script type="text/babel">
const { useState, useEffect, useCallback, useRef, useMemo } = React;

/* ‚îÄ‚îÄ HELPERS ‚îÄ‚îÄ */
const uid = () => Math.random().toString(36).slice(2,9);
const fmtDate = d => new Date(d).toLocaleDateString("pt-BR");
const fmtTime = d => new Date(d).toLocaleString("pt-BR",{day:"2-digit",month:"2-digit",hour:"2-digit",minute:"2-digit"});
const compressImage = file => new Promise(resolve=>{
  const r=new FileReader();
  r.onload=e=>{
    const img=new Image();
    img.onload=()=>{
      const MAX=360,ratio=Math.min(MAX/img.width,MAX/img.height,1);
      const c=document.createElement("canvas");
      c.width=img.width*ratio;c.height=img.height*ratio;
      c.getContext("2d").drawImage(img,0,0,c.width,c.height);
      resolve(c.toDataURL("image/jpeg",.78));
    };
    img.src=e.target.result;
  };
  r.readAsDataURL(file);
});

/* ‚îÄ‚îÄ FIREBASE DB ‚îÄ‚îÄ */
const FB_CONFIGURED = window.__FB_CONFIGURED__;
const db = FB_CONFIGURED ? window.db : null;

const col      = (c) => db.collection(c);
const fbAdd    = (c, data) => db.collection(c).doc(data.id).set(data);
const fbUpdate = (c, id, data) => db.collection(c).doc(id).update(data);
const fbDelete = (c, id) => db.collection(c).doc(id).delete();

/* ‚îÄ‚îÄ SETUP SCREEN (shown when Firebase not configured) ‚îÄ‚îÄ */
function SetupScreen() {
  return (
    <div style={{
      minHeight:"100vh", background:"var(--void)", display:"flex",
      alignItems:"center", justifyContent:"center", padding:"24px",
      fontFamily:"'Rajdhani',sans-serif"
    }}>
      <div style={{
        background:"var(--panel)", border:"1px solid var(--border)",
        borderTop:"3px solid var(--gold)", maxWidth:560, width:"100%", padding:"40px 36px"
      }}>
        <div style={{fontFamily:"'Bebas Neue',sans-serif",fontSize:"2rem",letterSpacing:4,
          background:"linear-gradient(135deg,var(--neon),var(--accent))",
          WebkitBackgroundClip:"text",WebkitTextFillColor:"transparent",
          backgroundClip:"text",marginBottom:8}}>MULTIVERSO</div>

        <div style={{fontFamily:"'Space Mono',monospace",fontSize:".7rem",
          color:"var(--gold)",letterSpacing:2,marginBottom:24}}>
          ‚öôÔ∏è CONFIGURA√á√ÉO DO BANCO DE DADOS
        </div>

        <p style={{color:"var(--text)",lineHeight:1.75,marginBottom:20,fontSize:"1rem"}}>
          O site ainda n√£o est√° conectado ao Firebase. Siga os passos abaixo para configurar:
        </p>

        {[
          {n:"1", txt:"Abra o arquivo index.html no Bloco de Notas (clique com o bot√£o direito ‚Üí Abrir com ‚Üí Bloco de Notas)"},
          {n:"2", txt:'Use Ctrl+F para buscar o texto COLE_AQUI_apiKey'},
          {n:"3", txt:"Substitua cada valor COLE_AQUI_... pelo valor correspondente copiado do Console do Firebase"},
          {n:"4", txt:"Salve o arquivo (Ctrl+S) e fa√ßa o upload novo no GitHub"},
        ].map(s => (
          <div key={s.n} style={{display:"flex",gap:14,marginBottom:14,alignItems:"flex-start"}}>
            <div style={{
              background:"var(--accent)",color:"#fff",width:26,height:26,
              borderRadius:"50%",display:"flex",alignItems:"center",justifyContent:"center",
              fontFamily:"'Bebas Neue',sans-serif",fontSize:"1rem",flexShrink:0,marginTop:2
            }}>{s.n}</div>
            <p style={{color:"var(--muted)",lineHeight:1.65,fontSize:".95rem"}}>{s.txt}</p>
          </div>
        ))}

        <div style={{
          background:"var(--deep)",border:"1px solid rgba(255,214,0,.25)",
          borderLeft:"3px solid var(--gold)",padding:"14px 16px",marginTop:24
        }}>
          <div style={{fontFamily:"'Space Mono',monospace",fontSize:".62rem",
            color:"var(--gold)",letterSpacing:2,marginBottom:8}}>
            üí° ONDE ENCONTRAR AS CREDENCIAIS
          </div>
          <p style={{color:"var(--muted)",fontSize:".88rem",lineHeight:1.7}}>
            Console do Firebase ‚Üí ‚öôÔ∏è Configura√ß√µes do projeto ‚Üí role at√© "Seus aplicativos" ‚Üí clique no app web ‚Üí se√ß√£o "firebaseConfig"
          </p>
          <a href="https://console.firebase.google.com" target="_blank" style={{
            display:"inline-block",marginTop:12,
            fontFamily:"'Space Mono',monospace",fontSize:".62rem",
            color:"var(--neon)",borderBottom:"1px solid var(--neon)",textDecoration:"none"
          }}>‚Üí Abrir Console do Firebase</a>
        </div>

        {window.__FB_ERROR__ && (
          <div style={{
            background:"rgba(255,60,95,.06)",border:"1px solid var(--border-hot)",
            padding:"12px 14px",marginTop:16
          }}>
            <div style={{fontFamily:"'Space Mono',monospace",fontSize:".6rem",color:"var(--accent)",marginBottom:4}}>
              ERRO T√âCNICO DETECTADO:
            </div>
            <code style={{fontSize:".78rem",color:"var(--muted)",wordBreak:"break-all"}}>
              {window.__FB_ERROR__}
            </code>
          </div>
        )}
      </div>
    </div>
  );
}

/* ‚îÄ‚îÄ CONSTANTS ‚îÄ‚îÄ */
const CATS=["HQ Marvel","HQ DC","HQ Indie","Mang√°","Funko Pop!","Figure","Colecion√°vel"];
const STATUSES=[
  {v:"ok",  label:"Em estoque",       color:"#4ade80"},
  {v:"low", label:"√öltimas unidades", color:"#ffd600"},
  {v:"pre", label:"Pr√©-venda",        color:"#00e5ff"},
  {v:"out", label:"Esgotado",         color:"#ff3c5f"},
];
const CAT_BG={
  "HQ Marvel":"linear-gradient(135deg,#3d0a0a,#1a0505)",
  "HQ DC":"linear-gradient(135deg,#0a1a3d,#050d1a)",
  "Mang√°":"linear-gradient(135deg,#0a200a,#051005)",
  "Funko Pop!":"linear-gradient(135deg,#200a30,#100518)",
  "Figure":"linear-gradient(135deg,#0a0a30,#050518)",
  "HQ Indie":"linear-gradient(135deg,#201a0a,#100c05)",
  "Colecion√°vel":"linear-gradient(135deg,#0a1a20,#050d10)",
};
const CAT_ICON={"HQ Marvel":"ü¶∏","HQ DC":"ü¶á","Mang√°":"‚öîÔ∏è","Funko Pop!":"üß∏","Figure":"üè∫","HQ Indie":"‚úçÔ∏è","Colecion√°vel":"üåü"};
const TYPE_COLOR={"Mang√°":"#00e5ff","HQ Marvel":"#ff3c5f","HQ DC":"#5b9aff","Funko Pop!":"#ffd600","Figure":"#b388ff","HQ Indie":"#4ade80","Colecion√°vel":"#ff8a65"};
const LOG_COLORS={estoque:"#00e5ff",produto:"#4ade80",reserva:"#ffd600",lancamento:"#ff8a65",cadastro:"#b388ff",sistema:"#5a6278"};

const INIT_PRODUCTS=[
  {id:uid(),name:"Homem-Aranha: Hobgoblin #1",cat:"HQ Marvel", price:39, stock:5, maxStock:5, image:null,status:"ok"},
  {id:uid(),name:"Jujutsu Kaisen Vol. 26",    cat:"Mang√°",     price:52, stock:2, maxStock:10,image:null,status:"low"},
  {id:uid(),name:"Goku Ultra Instinct Funko", cat:"Funko Pop!",price:89, stock:8, maxStock:8, image:null,status:"ok"},
  {id:uid(),name:"Batman: Ano Um",             cat:"HQ DC",     price:64, stock:3, maxStock:6, image:null,status:"ok"},
  {id:uid(),name:"One Piece Vol. 107",         cat:"Mang√°",     price:45, stock:1, maxStock:8, image:null,status:"low"},
  {id:uid(),name:"Miles Morales Glow Funko",  cat:"Funko Pop!",price:129,stock:0, maxStock:5, image:null,status:"out"},
];
const INIT_LAUNCHES=[
  {id:uid(),name:"Chainsaw Man Vol. 17",     date:"2025-03-28",type:"Mang√°",     note:"Panini PT-BR"},
  {id:uid(),name:"Funko Chase ‚Äî Tanjiro",    date:"2025-03-22",type:"Funko Pop!",note:"Ed. Limitada"},
  {id:uid(),name:"S.H.Figuarts Luffy Gear 5",date:"2025-04-10",type:"Figure",    note:"Bandai"},
  {id:uid(),name:"Absolute Batman #6",       date:"2025-04-18",type:"HQ DC",     note:"Scott Snyder"},
];

/* ‚îÄ‚îÄ COMPONENTS ‚îÄ‚îÄ */
function StatusBadge({status}){
  const st=STATUSES.find(s=>s.v===status)||STATUSES[0];
  return <span className="badge" style={{color:st.color,borderColor:st.color+"55"}}><span className="badge-dot" style={{background:st.color}}/>{st.label}</span>;
}
function StockBar({stock,maxStock,status}){
  if(status==="pre"||status==="out") return null;
  const pct=Math.max(0,Math.min(100,(stock/(maxStock||10))*100));
  const color=pct>50?"#4ade80":pct>20?"#ffd600":"#ff3c5f";
  return <div className="stock-bar-wrap"><div className="stock-bar" style={{width:pct+"%",background:color}}/></div>;
}
function ProductPlaceholder({cat}){
  return(
    <div className="product-placeholder" style={{background:CAT_BG[cat]||"var(--card)"}}>
      <span className="placeholder-icon">{CAT_ICON[cat]||"üì¶"}</span>
      <span className="placeholder-label">Sem foto</span>
      <span className="placeholder-cat">{cat}</span>
    </div>
  );
}
function ThumbSm({image,cat}){
  const abbr={"HQ Marvel":"MV","HQ DC":"DC","Mang√°":"MG","Funko Pop!":"FK","Figure":"FG","HQ Indie":"IN","Colecion√°vel":"CL"};
  return(
    <div className="thumb-sm" style={{background:CAT_BG[cat]||"var(--card)"}}>
      {image?<img src={image} alt=""/>:(abbr[cat]||cat[0])}
    </div>
  );
}
function ImagePicker({image,onChange}){
  const fRef=useRef(),vRef=useRef(),cRef=useRef();
  const [cam,setCam]=useState(false),[stream,setStream]=useState(null),[loading,setLoading]=useState(false),[err,setErr]=useState(null);
  useEffect(()=>{if(stream&&vRef.current) vRef.current.srcObject=stream;},[stream,cam]);
  const startCam=async()=>{setErr(null);try{const st=await navigator.mediaDevices.getUserMedia({video:{facingMode:"environment"},audio:false});setStream(st);setCam(true);}catch{setErr("Permiss√£o de c√¢mera negada.");}};
  const stopCam=()=>{if(stream) stream.getTracks().forEach(t=>t.stop());setStream(null);setCam(false);};
  const capture=()=>{const v=vRef.current,c=cRef.current;if(!v||!c) return;const MAX=360,r=Math.min(MAX/v.videoWidth,MAX/v.videoHeight,1);c.width=v.videoWidth*r;c.height=v.videoHeight*r;c.getContext("2d").drawImage(v,0,0,c.width,c.height);onChange(c.toDataURL("image/jpeg",.78));stopCam();};
  const handleFile=async e=>{const f=e.target.files[0];if(!f) return;setLoading(true);onChange(await compressImage(f));setLoading(false);e.target.value="";};
  return(
    <>
      <div className="img-picker">
        <div style={{display:"flex",alignItems:"center",gap:16}}>
          <div className={`img-preview${image?" has-image":""}`}>{image?<img src={image} alt=""/>:"üì∑"}</div>
          <div style={{display:"flex",flexDirection:"column",gap:8}}>
            <button className="btn-neon" onClick={()=>fRef.current.click()}>üñºÔ∏è Galeria / Arquivo</button>
            <button className="btn-neon" onClick={startCam}>üì∏ C√¢mera</button>
            {image&&<button className="btn-danger" onClick={()=>onChange(null)}>üóëÔ∏è Remover</button>}
          </div>
        </div>
        {loading&&<div style={{fontFamily:"monospace",fontSize:".68rem",color:"var(--neon)",marginTop:10}}>‚è≥ Processando...</div>}
        {err&&<div style={{fontFamily:"monospace",fontSize:".68rem",color:"var(--accent)",marginTop:10}}>‚ö†Ô∏è {err}</div>}
      </div>
      <input ref={fRef} type="file" accept="image/*" style={{display:"none"}} onChange={handleFile}/>
      <canvas ref={cRef} style={{display:"none"}}/>
      {cam&&(
        <div className="cam-modal">
          <div style={{fontFamily:"'Bebas Neue',sans-serif",fontSize:"1.3rem",letterSpacing:4,color:"var(--neon)"}}>üì∏ C√ÇMERA</div>
          <div className="cam-viewfinder"><video ref={vRef} autoPlay playsInline muted/><div className="cam-corner tl"/><div className="cam-corner tr"/><div className="cam-corner bl"/><div className="cam-corner br"/></div>
          <div style={{display:"flex",gap:12}}><button className="btn-primary" onClick={capture}>üì∏ Capturar</button><button className="btn-ghost" onClick={stopCam}>Cancelar</button></div>
        </div>
      )}
    </>
  );
}
function Toast({msg,color="#4ade80",onClose}){
  useEffect(()=>{const t=setTimeout(onClose,3200);return()=>clearTimeout(t);},[onClose]);
  return <div className="toast" style={{background:color}}>{msg}</div>;
}

/* ‚îÄ‚îÄ THEME PICKER ‚îÄ‚îÄ */
const THEMES=[
  {id:"dark",  icon:"üåë",label:"Escuro",   desc:"Tema padr√£o ‚Äî fundo escuro"},
  {id:"light", icon:"‚òÄÔ∏è", label:"Claro",    desc:"Fundo branco ‚Äî ambiente iluminado"},
  {id:"access",icon:"‚ôø", label:"Acess√≠vel",desc:"Alto contraste ‚Äî autismo, daltonismo, baixa vis√£o"},
];
function ThemePicker({theme,setTheme}){
  const [open,setOpen]=useState(false);const ref=useRef();
  useEffect(()=>{document.body.setAttribute("data-theme",theme==="dark"?"":theme);try{localStorage.setItem("mv-theme",theme);}catch{}},[theme]);
  useEffect(()=>{const h=e=>{if(ref.current&&!ref.current.contains(e.target)) setOpen(false);};document.addEventListener("mousedown",h);return()=>document.removeEventListener("mousedown",h);},[]);
  const cur=THEMES.find(t=>t.id===theme)||THEMES[0];
  return(
    <div ref={ref} style={{position:"relative"}}>
      <button onClick={()=>setOpen(o=>!o)} className="nav-tab" title="Tema de cores" style={{display:"flex",alignItems:"center",gap:5}}>
        <span style={{fontSize:"1rem",lineHeight:1}}>{cur.icon}</span>
        <span style={{fontSize:".5rem",color:"var(--muted)"}}>‚ñº</span>
      </button>
      {open&&(
        <div style={{position:"absolute",top:"calc(100% + 8px)",right:0,background:"var(--panel)",border:"1px solid var(--border)",borderTop:"2px solid var(--neon)",minWidth:240,zIndex:300,boxShadow:"0 16px 48px rgba(0,0,0,.5)",animation:"panelIn .2s ease"}}>
          <div style={{padding:"10px 14px 8px",fontFamily:"'Space Mono',monospace",fontSize:".58rem",color:"var(--muted)",letterSpacing:2,textTransform:"uppercase",borderBottom:"1px solid var(--border)"}}>üé® Tema de Cores</div>
          {THEMES.map(t=>(
            <button key={t.id} onClick={()=>{setTheme(t.id);setOpen(false);}}
              style={{width:"100%",background:theme===t.id?"rgba(0,229,255,.08)":"transparent",border:"none",borderBottom:"1px solid var(--border)",padding:"12px 14px",display:"flex",alignItems:"center",gap:12,cursor:"pointer",textAlign:"left"}}
              onMouseEnter={e=>e.currentTarget.style.background="rgba(255,255,255,.05)"}
              onMouseLeave={e=>e.currentTarget.style.background=theme===t.id?"rgba(0,229,255,.08)":"transparent"}>
              <span style={{fontSize:"1.4rem",lineHeight:1,flexShrink:0}}>{t.icon}</span>
              <div style={{flex:1,minWidth:0}}>
                <div style={{fontFamily:"'Bebas Neue',sans-serif",fontSize:"1rem",letterSpacing:2,color:theme===t.id?"var(--neon)":"var(--text)",display:"flex",alignItems:"center",gap:8}}>
                  {t.label}{theme===t.id&&<span style={{fontFamily:"'Space Mono',monospace",fontSize:".5rem",color:"var(--neon)",border:"1px solid var(--neon)",padding:"1px 5px"}}>ATIVO</span>}
                </div>
                <div style={{fontFamily:"'Space Mono',monospace",fontSize:".55rem",color:"var(--muted)",marginTop:3,lineHeight:1.4}}>{t.desc}</div>
              </div>
            </button>
          ))}
          <div style={{padding:"8px 14px 10px",fontFamily:"'Space Mono',monospace",fontSize:".52rem",color:"var(--muted)",lineHeight:1.7,borderTop:"1px solid var(--border)"}}>‚ôø Modo acess√≠vel remove anima√ß√µes e aumenta o contraste para necessidades visuais ou cognitivas.</div>
        </div>
      )}
    </div>
  );
}

/* ‚îÄ‚îÄ PRODUCT MODAL ‚îÄ‚îÄ */
function ProductModal({product,wishes,onClose,onReserve,onWish}){
  const [tab,setTab]=useState(product.status==="out"?"wish":"reserve");
  const [name,setName]=useState(""),[contact,setContact]=useState(""),[ctype,setCtype]=useState("whatsapp"),[note,setNote]=useState("");
  const [done,setDone]=useState(false);
  const wc=wishes.filter(w=>w.productId===product.id).length;
  const submit=()=>{
    if(!name||!contact) return;
    const base={id:uid(),productId:product.id,productName:product.name,productCat:product.cat,name,contact,contactType:ctype,date:new Date().toISOString()};
    if(tab==="reserve") onReserve({...base,note,status:"pending"});
    else onWish(base);
    setDone(true);
  };
  return(
    <div className="modal-overlay" onClick={e=>{if(e.target===e.currentTarget) onClose()}}>
      <div className="modal-box">
        <div className="modal-header">
          <div style={{flex:1}}>
            <div style={{fontFamily:"'Space Mono',monospace",fontSize:".58rem",color:TYPE_COLOR[product.cat]||"var(--neon)",letterSpacing:2,textTransform:"uppercase",marginBottom:6}}>{product.cat}</div>
            <div style={{fontFamily:"'Bebas Neue',sans-serif",fontSize:"1.5rem",letterSpacing:2,lineHeight:1.1}}>{product.name}</div>
            <div style={{display:"flex",alignItems:"center",gap:10,marginTop:10,flexWrap:"wrap"}}>
              <div style={{fontFamily:"'Bebas Neue',sans-serif",fontSize:"2rem",color:"var(--neon)"}}>R${product.price}</div>
              <StatusBadge status={product.status}/>
              {wc>0&&<span style={{fontFamily:"'Space Mono',monospace",fontSize:".55rem",color:"var(--gold)",border:"1px solid var(--gold)",padding:"2px 8px"}}>‚ù§Ô∏è {wc} na espera</span>}
            </div>
          </div>
          {product.image&&<div style={{width:70,height:70,overflow:"hidden",flexShrink:0,border:"1px solid var(--border)"}}><img src={product.image} alt="" style={{width:"100%",height:"100%",objectFit:"cover"}}/></div>}
          <button className="modal-close" onClick={onClose}>‚úï</button>
        </div>
        {done?(
          <div className="modal-body" style={{textAlign:"center",padding:"36px 24px"}}>
            <div style={{fontSize:"3rem",marginBottom:12}}>üéâ</div>
            <div style={{fontFamily:"'Bebas Neue',sans-serif",fontSize:"1.6rem",color:"var(--green)",letterSpacing:2}}>{tab==="reserve"?"Reserva Enviada!":"Na Lista de Espera!"}</div>
            <p style={{color:"var(--muted)",marginTop:8,fontSize:".9rem"}}>O dono da banca entrar√° em contato em breve.</p>
            <button className="btn-ghost" onClick={onClose} style={{marginTop:20}}>Fechar</button>
          </div>
        ):(
          <>
            <div style={{padding:"0 24px"}}>
              <div className="modal-tabs">
                {product.status!=="out"&&<button className={`modal-tab${tab==="reserve"?" active":""}`} onClick={()=>setTab("reserve")}>üõí Reservar</button>}
                <button className={`modal-tab${tab==="wish"?" active":""}`} onClick={()=>setTab("wish")}>‚ù§Ô∏è Avise-me</button>
              </div>
            </div>
            <div className="modal-body">
              <p style={{color:"var(--muted)",fontSize:".88rem",marginBottom:16,lineHeight:1.6}}>
                {tab==="reserve"?"Fa√ßa sua reserva e retire na banca. Entraremos em contato para confirmar.":"Seja avisado quando este item chegar em estoque novamente."}
              </p>
              <label className="field-label">Seu Nome</label>
              <input value={name} onChange={e=>setName(e.target.value)} placeholder="Ex: Jo√£o Silva" className="field-input"/>
              <div style={{display:"grid",gridTemplateColumns:"1fr 1fr",gap:12}}>
                <div><label className="field-label">Contato via</label><select value={ctype} onChange={e=>setCtype(e.target.value)} className="field-input"><option value="whatsapp">üì± WhatsApp</option><option value="email">üìß E-mail</option></select></div>
                <div><label className="field-label">{ctype==="whatsapp"?"N√∫mero":"E-mail"}</label><input value={contact} onChange={e=>setContact(e.target.value)} placeholder={ctype==="whatsapp"?"(21) 99999-0000":"seu@email.com"} className="field-input"/></div>
              </div>
              {tab==="reserve"&&<><label className="field-label">Observa√ß√£o (opcional)</label><input value={note} onChange={e=>setNote(e.target.value)} placeholder="Quantidade, edi√ß√£o preferida..." className="field-input"/></>}
              <button className="btn-primary" onClick={submit} style={{width:"100%",padding:14,fontSize:"1rem",clipPath:"none",marginTop:4}}>
                {tab==="reserve"?"üõí Confirmar Reserva":"‚ù§Ô∏è Entrar na Lista"}
              </button>
            </div>
          </>
        )}
      </div>
    </div>
  );
}

/* ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê
   CUSTOMER PAGE
‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê */
function CustomerPage({products,launches,reservations,wishes,onReserve,onWish,onNotifySignup}){
  const [name,setName]=useState(""),[contact,setContact]=useState(""),[ctype,setCtype]=useState("whatsapp");
  const [interest,setInterest]=useState(""),[submitted,setSubmitted]=useState(false);
  const [search,setSearch]=useState(""),[filterCat,setFilterCat]=useState("Todos");
  const [launchSearch,setLaunchSearch]=useState("");
  const [selectedProduct,setSelectedProduct]=useState(null);
  const cats=["Todos",...new Set(products.map(p=>p.cat))];
  const filtered=products.filter(p=>(filterCat==="Todos"||p.cat===filterCat)&&p.name.toLowerCase().includes(search.toLowerCase()));
  const upcoming=[...launches].sort((a,b)=>new Date(a.date)-new Date(b.date)).filter(l=>l.name.toLowerCase().includes(launchSearch.toLowerCase())||l.type.toLowerCase().includes(launchSearch.toLowerCase()));
  const handleNotify=()=>{
    if(!name||!contact) return;
    onNotifySignup({id:uid(),name,contact,contactType:ctype,interest,date:new Date().toISOString()});
    setSubmitted(true);
  };
  return(
    <div style={{paddingTop:60}}>
      <div className="hero">
        <div className="comic-bg"/>
        <div className="hero-glow hero-glow-1"/><div className="hero-glow hero-glow-2"/>
        <div className="hero-tag">Banca Geek</div>
        <h1><span>Seu Portal</span><span className="line-neon">Multiverso</span></h1>
        <p className="hero-desc">HQs, mang√°s, funkos e colecion√°veis. Reserve online, entre na lista de espera e nunca perca um lan√ßamento.</p>
        <div className="hero-actions"><a className="btn-primary" href="#catalogo">üìö Ver Cat√°logo</a><a className="btn-ghost" href="#notify">üîî Notifica√ß√µes</a></div>
      </div>
      <div className="marquee-bar">
        <div className="marquee-track">
          {["HQS MARVEL","DC COMICS","MANG√ÅS","FUNKOS","FIGURES","INDIE","COLECION√ÅVEIS","NOVIDADES","HQS MARVEL","DC COMICS","MANG√ÅS","FUNKOS","FIGURES","INDIE","COLECION√ÅVEIS","NOVIDADES"].map((item,i)=>(
            <React.Fragment key={i}><span className="marquee-item">{item}</span><span className="marquee-dot">‚óÜ</span></React.Fragment>
          ))}
        </div>
      </div>

      {/* LAN√áAMENTOS */}
      <div className="section">
        <div className="s-container">
          <div className="section-head"><div><div className="section-tag">// Agenda</div><div className="section-title">Pr√≥ximos Lan√ßamentos</div></div></div>
          <div style={{position:"relative",marginBottom:16}}>
            <input value={launchSearch} onChange={e=>setLaunchSearch(e.target.value)} placeholder="Buscar por t√≠tulo ou tipo..." className="field-input" style={{paddingLeft:36,marginBottom:0}}/>
            <span style={{position:"absolute",left:11,top:"50%",transform:"translateY(-50%)",opacity:.4,fontSize:14}}>üîç</span>
          </div>
          {upcoming.length===0?<div className="empty"><span className="empty-icon">üóìÔ∏è</span>Nenhum lan√ßamento encontrado.</div>
            :upcoming.map(l=>{const d=new Date(l.date+"T00:00:00");return(
            <div className="launch-item" key={l.id}>
              <div style={{textAlign:"center",minWidth:48}}>
                <div style={{fontFamily:"'Bebas Neue',sans-serif",fontSize:"2.2rem",color:"var(--accent)",lineHeight:1}}>{d.getDate()}</div>
                <div style={{fontFamily:"'Space Mono',monospace",fontSize:".55rem",color:"var(--muted)",letterSpacing:2}}>{d.toLocaleString("pt-BR",{month:"short"}).toUpperCase()}</div>
              </div>
              <div style={{width:1,height:44,background:"var(--border)"}}/>
              <div style={{flex:1,minWidth:0}}>
                <div style={{fontFamily:"'Space Mono',monospace",fontSize:".58rem",color:TYPE_COLOR[l.type]||"var(--neon)",letterSpacing:2,marginBottom:4,textTransform:"uppercase"}}>{l.type}</div>
                <div style={{fontWeight:700,fontSize:"1rem",lineHeight:1.3}}>{l.name}</div>
                {l.note&&<div style={{fontSize:".82rem",color:"var(--muted)",marginTop:3}}>{l.note}</div>}
              </div>
              <a className="btn-ghost" href="#notify" style={{fontSize:".58rem",color:"var(--accent)",borderColor:"var(--border-hot)",whiteSpace:"nowrap"}}>Reservar ‚Üí</a>
            </div>
          );})}
        </div>
      </div>

      {/* CAT√ÅLOGO */}
      <div className="section" id="catalogo" style={{background:"var(--deep)",borderTop:"1px solid var(--border)",borderBottom:"1px solid var(--border)"}}>
        <div className="s-container">
          <div className="section-head"><div><div className="section-tag">// Dispon√≠vel</div><div className="section-title">Cat√°logo</div></div></div>
          <div style={{display:"flex",gap:8,marginBottom:20,flexWrap:"wrap"}}>
            <div style={{position:"relative",flex:"1 1 200px"}}>
              <input value={search} onChange={e=>setSearch(e.target.value)} placeholder="Buscar produto..." className="field-input" style={{paddingLeft:36,marginBottom:0}}/>
              <span style={{position:"absolute",left:11,top:"50%",transform:"translateY(-50%)",fontSize:14,opacity:.4}}>üîç</span>
            </div>
            <div style={{display:"flex",gap:4,flexWrap:"wrap"}}>
              {cats.map(c=><button key={c} className={`nav-tab${filterCat===c?" active":""}`} onClick={()=>setFilterCat(c)} style={{fontSize:".58rem",padding:"7px 12px"}}>{c}</button>)}
            </div>
          </div>
          {filtered.length===0?<div className="empty"><span className="empty-icon">üîç</span>Nenhum produto encontrado.</div>
            :<div className="catalog-grid">{filtered.map(p=>{const wc=wishes.filter(w=>w.productId===p.id).length;return(
            <div className="product-card" key={p.id} onClick={()=>setSelectedProduct(p)}>
              {wc>0&&<div className="wish-badge">‚ù§Ô∏è {wc}</div>}
              <div className="product-thumb">{p.image?<img src={p.image} alt={p.name}/>:<ProductPlaceholder cat={p.cat}/>}</div>
              <div className="product-info">
                <div className="product-cat">{p.cat}</div>
                <div className="product-name">{p.name}</div>
                <StockBar stock={p.stock} maxStock={p.maxStock} status={p.status}/>
                <div className="product-footer"><div className="product-price">R${p.price}</div><StatusBadge status={p.status}/></div>
              </div>
            </div>
          );})}</div>}
          <p style={{fontFamily:"'Space Mono',monospace",fontSize:".6rem",color:"var(--muted)",marginTop:16,textAlign:"center"}}>Clique num produto para reservar ou entrar na lista de espera.</p>
        </div>
      </div>

      {/* FEATURES */}
      <div className="section">
        <div className="s-container">
          <div className="section-head"><div><div className="section-tag">// Diferenciais</div><div className="section-title">Por que o Multiverso?</div></div></div>
          <div className="features-grid">
            {[{n:"01",icon:"üõí",title:"Reserva Online",desc:"Clique no produto e garanta o item antes de esgotar. Retire na banca na sua hora."},{n:"02",icon:"‚ù§Ô∏è",title:"Lista de Espera",desc:"Produto esgotado? Entre na lista e receba aviso assim que ele voltar ao estoque."},{n:"03",icon:"üîî",title:"Notifica√ß√µes",desc:"Cadastre-se para receber avisos gerais de novidades, promo√ß√µes e lan√ßamentos."},{n:"04",icon:"üóìÔ∏è",title:"Calend√°rio Geek",desc:"Todos os lan√ßamentos Marvel, DC, Sh≈çnen e mais ‚Äî centralizados e sempre atualizados."}].map(f=>(
              <div className="feature-card" key={f.n}>
                <span className="feature-num">{f.n}</span><span className="feature-icon">{f.icon}</span>
                <div className="feature-title">{f.title}</div><p className="feature-desc">{f.desc}</p>
              </div>
            ))}
          </div>
        </div>
      </div>

      {/* NOTIFY */}
      <div className="section notify-section" id="notify">
        <div className="s-container">
          <div className="section-tag" style={{justifyContent:"center",display:"flex"}}>// Fique por dentro</div>
          <div className="section-title" style={{textAlign:"center",fontSize:"clamp(2rem,5vw,3.2rem)",marginBottom:12}}>Receba Notifica√ß√µes</div>
          <p style={{color:"var(--muted)",textAlign:"center",maxWidth:420,margin:"0 auto 36px",lineHeight:1.7,fontSize:".98rem"}}>Cadastre-se para receber avisos de novidades e lan√ßamentos por WhatsApp ou e-mail.</p>
          {submitted?(
            <div style={{textAlign:"center",padding:"48px 0",animation:"fadeUp .5s ease"}}>
              <div style={{fontSize:"3.5rem",marginBottom:16}}>üéâ</div>
              <div style={{fontFamily:"'Bebas Neue',sans-serif",fontSize:"2rem",color:"var(--green)",letterSpacing:3}}>Cadastro Confirmado!</div>
              <p style={{color:"var(--muted)",marginTop:10}}>Voc√™ ser√° avisado assim que tiver novidade.</p>
            </div>
          ):(
            <div style={{maxWidth:560,margin:"0 auto"}}>
              <div className="form-grid" style={{marginBottom:14}}>
                <div className="col-full"><label className="field-label">Seu Nome</label><input value={name} onChange={e=>setName(e.target.value)} placeholder="Ex: Jo√£o Silva" className="field-input"/></div>
                <div><label className="field-label">Contato via</label><select value={ctype} onChange={e=>setCtype(e.target.value)} className="field-input"><option value="whatsapp">üì± WhatsApp</option><option value="email">üìß E-mail</option></select></div>
                <div><label className="field-label">{ctype==="whatsapp"?"WhatsApp":"E-mail"}</label><input value={contact} onChange={e=>setContact(e.target.value)} placeholder={ctype==="whatsapp"?"(21) 99999-0000":"seu@email.com"} className="field-input"/></div>
                <div className="col-full"><label className="field-label">Interesse (opcional)</label><input value={interest} onChange={e=>setInterest(e.target.value)} placeholder="Ex: Mang√°s sh≈çnen, HQs DC, Funkos exclusivos..." className="field-input"/></div>
              </div>
              <button className="btn-primary" onClick={handleNotify} style={{width:"100%",padding:14,fontSize:"1.1rem",clipPath:"none"}}>üîî Quero ser Notificado</button>
            </div>
          )}
        </div>
      </div>
      <footer>
        <div style={{fontFamily:"'Bebas Neue',sans-serif",fontSize:"1.5rem",letterSpacing:4,background:"linear-gradient(90deg,var(--neon),var(--accent))",WebkitBackgroundClip:"text",WebkitTextFillColor:"transparent",backgroundClip:"text",marginBottom:12}}>MULTIVERSO</div>
        <p style={{fontFamily:"'Space Mono',monospace",fontSize:".6rem",color:"var(--muted)",letterSpacing:2}}>¬© 2025 ‚Äî Banca Geek ¬∑ Feito com ‚ù§Ô∏è para os f√£s</p>
      </footer>
      {selectedProduct&&<ProductModal product={selectedProduct} wishes={wishes} onClose={()=>setSelectedProduct(null)} onReserve={onReserve} onWish={onWish}/>}
    </div>
  );
}

/* ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê
   ADMIN LOGIN
‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê */
function AdminLogin({onLogin}){
  const [pass,setPass]=useState(""),[err,setErr]=useState(false),[loading,setLoading]=useState(false);
  const go=async()=>{setLoading(true);await new Promise(r=>setTimeout(r,400));if(pass==="MultiversoDM") onLogin();else{setErr(true);setLoading(false);}};
  return(
    <div style={{paddingTop:60,display:"flex",alignItems:"center",justifyContent:"center",minHeight:"100svh",padding:"80px 16px 40px"}}>
      <div className="login-card">
        <div style={{textAlign:"center",marginBottom:36}}>
          <div style={{fontFamily:"'Bebas Neue',sans-serif",fontSize:"2rem",letterSpacing:4,background:"linear-gradient(135deg,var(--neon),var(--accent))",WebkitBackgroundClip:"text",WebkitTextFillColor:"transparent",backgroundClip:"text",marginBottom:8}}>MULTIVERSO</div>
          <div style={{fontFamily:"'Space Mono',monospace",fontSize:".6rem",color:"var(--muted)",letterSpacing:4}}>PAINEL ADMIN</div>
        </div>
        <label className="field-label">üîí Senha de Acesso</label>
        <input type="password" value={pass} onChange={e=>{setPass(e.target.value);setErr(false);}} onKeyDown={e=>e.key==="Enter"&&go()} placeholder="‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢" className="field-input" style={{borderColor:err?"var(--accent)":undefined}}/>
        {err&&<div style={{fontFamily:"monospace",fontSize:".65rem",color:"var(--accent)",marginBottom:12}}>‚ö†Ô∏è Senha incorreta. Tente novamente.</div>}
        <button className="btn-primary" onClick={go} disabled={loading} style={{width:"100%",padding:14,fontSize:"1.1rem",clipPath:"none",opacity:loading?.7:1}}>{loading?"Verificando...":"Entrar no Painel"}</button>
        <div style={{marginTop:20,fontFamily:"monospace",fontSize:".6rem",color:"var(--muted)",textAlign:"center",lineHeight:2}}>√Årea restrita ‚Äî acesso autorizado apenas para administradores da banca.</div>
      </div>
    </div>
  );
}

/* ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê
   ADMIN PANEL
‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê */
function AdminPanel({products,launches,subscribers,reservations,wishes,activityLog,onLogout,onToast,onAddLog,synced}){
  const [tab,setTab]=useState("dashboard");
  const pending=reservations.filter(r=>r.status==="pending").length;
  const tabs=[
    {id:"dashboard",   label:"Dashboard",   e:"üìä"},
    {id:"products",    label:"Cat√°logo",    e:"üìö"},
    {id:"reservas",    label:"Reservas",    e:"üõí",badge:pending},
    {id:"launches",    label:"Lan√ßamentos", e:"üóìÔ∏è"},
    {id:"subscribers", label:"Notifica√ß√µes",e:"üîî"},
    {id:"relatorio",   label:"Relat√≥rio",   e:"üìà"},
  ];
  return(
    <div style={{paddingTop:60}}>
      <div className="admin-subnav">
        <div className="admin-tabs">
          {tabs.map(t=>(
            <button key={t.id} className={`nav-tab${tab===t.id?" active":""}`} onClick={()=>setTab(t.id)}>
              {t.e} {t.label}{t.badge>0&&<span className="nav-badge">{t.badge}</span>}
            </button>
          ))}
        </div>
        <div style={{display:"flex",alignItems:"center",gap:12}}>
          <div style={{display:"flex",alignItems:"center",gap:5,fontFamily:"'Space Mono',monospace",fontSize:".55rem",color:"var(--muted)"}}>
            <span className={`sync-dot${synced?"":" offline"}`}/>
            {synced?"Sincronizado":"Reconectando..."}
          </div>
          <button className="btn-ghost" onClick={onLogout} style={{fontSize:".58rem",padding:"7px 12px"}}>üö™ Sair</button>
        </div>
      </div>
      <div className="s-container" style={{padding:"32px 20px"}}>
        {tab==="dashboard"   && <Dashboard products={products} launches={launches} subscribers={subscribers} reservations={reservations} wishes={wishes} activityLog={activityLog}/>}
        {tab==="products"    && <ProductsAdmin products={products} onToast={onToast} onAddLog={onAddLog}/>}
        {tab==="reservas"    && <ReservasAdmin reservations={reservations} wishes={wishes} products={products} onToast={onToast}/>}
        {tab==="launches"    && <LaunchesAdmin launches={launches} onToast={onToast} onAddLog={onAddLog}/>}
        {tab==="subscribers" && <SubscribersAdmin subscribers={subscribers}/>}
        {tab==="relatorio"   && <Relatorio products={products} subscribers={subscribers} reservations={reservations} wishes={wishes}/>}
      </div>
    </div>
  );
}

/* ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê
   DASHBOARD
‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê */
function Dashboard({products,launches,subscribers,reservations,wishes,activityLog}){
  const lowStock=products.filter(p=>p.stock<=2&&p.status!=="pre"&&p.status!=="out");
  const pending=reservations.filter(r=>r.status==="pending");
  const upcoming=[...launches].sort((a,b)=>new Date(a.date)-new Date(b.date)).slice(0,3);
  const stats=[
    {num:products.length,    label:"Itens no Cat√°logo",  color:"var(--neon)"},
    {num:pending.length,     label:"Reservas Pendentes", color:"var(--gold)"},
    {num:subscribers.length, label:"Cadastros Notif.",   color:"var(--accent)"},
    {num:wishes.length,      label:"Listas de Espera",   color:"var(--purple)"},
  ];
  return(
    <div>
      <div style={{marginBottom:28,paddingBottom:16,borderBottom:"1px solid var(--border)"}}>
        <div className="section-tag">// Vis√£o Geral</div><div className="section-title">Dashboard</div>
      </div>
      <div className="stats-row">
        {stats.map((st,i)=>(
          <div key={i} className="stat-card" style={{borderTopColor:st.color}}>
            <div className="stat-num" style={{color:st.color}}>{st.num}</div>
            <div className="stat-label">{st.label}</div>
          </div>
        ))}
      </div>
      {pending.length>0&&(
        <div style={{marginBottom:28,background:"rgba(255,214,0,.04)",border:"1px solid rgba(255,214,0,.2)",borderLeft:"3px solid var(--gold)",padding:"18px 20px"}}>
          <div style={{fontFamily:"'Space Mono',monospace",fontSize:".62rem",color:"var(--gold)",letterSpacing:3,marginBottom:12,textTransform:"uppercase"}}>üõí Reservas Aguardando Confirma√ß√£o</div>
          {pending.slice(0,4).map(r=>(
            <div key={r.id} style={{display:"flex",alignItems:"center",gap:10,marginBottom:8,flexWrap:"wrap"}}>
              <div style={{flex:1,minWidth:140}}><span style={{fontWeight:700}}>{r.name}</span><span style={{color:"var(--muted)",fontSize:".85rem"}}> ‚Äî {r.productName}</span></div>
              <span style={{fontFamily:"'Space Mono',monospace",fontSize:".58rem",color:"#4ade80"}}>{r.contact}</span>
            </div>
          ))}
          {pending.length>4&&<div style={{fontFamily:"'Space Mono',monospace",fontSize:".6rem",color:"var(--muted)",marginTop:8}}>+{pending.length-4} mais reservas pendentes</div>}
        </div>
      )}
      {lowStock.length>0&&(
        <div style={{marginBottom:28}}>
          <div style={{fontFamily:"'Space Mono',monospace",fontSize:".62rem",color:"var(--gold)",letterSpacing:3,marginBottom:12,textTransform:"uppercase"}}>‚ö†Ô∏è Estoque Cr√≠tico</div>
          {lowStock.map(p=>(
            <div key={p.id} style={{background:"var(--panel)",border:"1px solid var(--border)",borderLeft:"3px solid var(--gold)",padding:"12px 16px",marginBottom:2,display:"flex",alignItems:"center",gap:12}}>
              <ThumbSm image={p.image} cat={p.cat}/>
              <div style={{flex:1,minWidth:0}}><div style={{fontWeight:700}}>{p.name}</div><div style={{fontFamily:"'Space Mono',monospace",fontSize:".6rem",color:"var(--muted)"}}>{p.cat}</div></div>
              <span style={{fontFamily:"'Space Mono',monospace",fontSize:".65rem",color:"var(--gold)",border:"1px solid var(--gold)",padding:"3px 10px"}}>{p.stock} unid.</span>
            </div>
          ))}
        </div>
      )}
      <div style={{display:"grid",gridTemplateColumns:"1fr 1fr",gap:16}}>
        <div>
          <div style={{fontFamily:"'Space Mono',monospace",fontSize:".62rem",color:"var(--neon)",letterSpacing:3,marginBottom:12,textTransform:"uppercase"}}>üìÖ Pr√≥ximos Lan√ßamentos</div>
          {upcoming.length===0?<div className="empty" style={{padding:"20px 0"}}><span className="empty-icon" style={{fontSize:"1.5rem"}}>üóìÔ∏è</span>Nenhum.</div>
            :upcoming.map(l=>(
            <div key={l.id} style={{background:"var(--panel)",border:"1px solid var(--border)",borderLeft:"3px solid var(--accent)",padding:"10px 14px",marginBottom:2,display:"flex",alignItems:"center",gap:10}}>
              <div style={{fontFamily:"'Bebas Neue',sans-serif",fontSize:"1.6rem",color:"var(--accent)",minWidth:32,textAlign:"center",lineHeight:1}}>{new Date(l.date+"T00:00:00").getDate()}</div>
              <div style={{flex:1,minWidth:0}}><div style={{fontWeight:700,fontSize:".9rem"}}>{l.name}</div><div style={{fontFamily:"'Space Mono',monospace",fontSize:".55rem",color:"var(--muted)"}}>{l.type}</div></div>
            </div>
          ))}
        </div>
        <div>
          <div style={{fontFamily:"'Space Mono',monospace",fontSize:".62rem",color:"var(--purple)",letterSpacing:3,marginBottom:12,textTransform:"uppercase"}}>üïê Atividade Recente</div>
          {activityLog.length===0?<div className="empty" style={{padding:"20px 0"}}><span className="empty-icon" style={{fontSize:"1.5rem"}}>üìã</span>Sem atividade.</div>
            :activityLog.slice(0,7).map(l=>(
            <div key={l.id} className="log-item">
              <div className="log-dot" style={{background:LOG_COLORS[l.type]||"var(--muted)"}}/>
              <div><div style={{fontSize:".88rem",lineHeight:1.4}}>{l.msg}</div><div style={{fontFamily:"'Space Mono',monospace",fontSize:".55rem",color:"var(--muted)",marginTop:3}}>{fmtTime(l.date)}</div></div>
            </div>
          ))}
        </div>
      </div>
    </div>
  );
}

/* ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê
   PRODUCTS ADMIN ‚Äî Firebase
‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê */
function ProductsAdmin({products,onToast,onAddLog}){
  const empty={name:"",cat:"HQ Marvel",price:"",stock:"",maxStock:"",image:null,status:"ok"};
  const [editing,setEditing]=useState(null),[showForm,setShowForm]=useState(false),[form,setForm]=useState(empty),[search,setSearch]=useState("");
  const filtered=products.filter(p=>p.name.toLowerCase().includes(search.toLowerCase())||p.cat.toLowerCase().includes(search.toLowerCase()));

  const openNew=()=>{setEditing(null);setForm(empty);setShowForm(true);};
  const openEdit=p=>{setEditing(p.id);setForm({name:p.name,cat:p.cat,price:p.price,stock:p.stock,maxStock:p.maxStock||p.stock,image:p.image||null,status:p.status});setShowForm(true);};

  const handleSave=async()=>{
    if(!form.name||!form.price) return;
    const data={...form,price:Number(form.price),stock:Number(form.stock),maxStock:Number(form.maxStock)||Number(form.stock)};
    if(editing){
      await fbUpdate("products",editing,data);
      onToast("‚úÖ Produto atualizado!");onAddLog(`Produto editado: ${data.name}`,"produto");
    } else {
      const id=uid();
      await fbAdd("products",{id,...data});
      onToast("‚úÖ Produto adicionado!");onAddLog(`Novo produto: ${data.name}`,"produto");
    }
    setShowForm(false);setEditing(null);
  };

  const handleDelete=async id=>{
    const p=products.find(x=>x.id===id);
    await fbDelete("products",id);
    onToast("üóëÔ∏è Produto removido.");onAddLog(`Produto removido: ${p?.name||id}`,"produto");
  };

  const adjustStock=async(id,delta)=>{
    const p=products.find(x=>x.id===id);if(!p) return;
    const ns=Math.max(0,p.stock+delta);
    let st=p.status;
    if(ns===0&&st!=="pre") st="out";
    else if(ns>0&&st==="out") st=ns<=2?"low":"ok";
    else if(ns<=2&&st==="ok") st="low";
    else if(ns>2&&st==="low") st="ok";
    await fbUpdate("products",id,{stock:ns,status:st});
    onToast(`üì¶ ${p.name}: ${ns} unid.`);
    onAddLog(`Estoque ajustado ‚Äî ${p.name}: ${p.stock}‚Üí${ns}`,"estoque");
  };

  return(
    <div>
      <div className="section-head">
        <div><div className="section-tag">// Admin</div><div className="section-title">Cat√°logo</div></div>
        <button className="btn-primary" onClick={openNew}>+ Novo Produto</button>
      </div>
      {showForm&&(
        <div className="form-panel">
          <div className="form-title">{editing?"‚úèÔ∏è EDITAR PRODUTO":"‚ú® NOVO PRODUTO"}</div>
          <div className="form-grid">
            <div className="col-full"><label className="field-label">Nome do Produto</label><input value={form.name} onChange={e=>setForm(f=>({...f,name:e.target.value}))} placeholder="Ex: Batman: Ano Um" className="field-input"/></div>
            <div><label className="field-label">Categoria</label><select value={form.cat} onChange={e=>setForm(f=>({...f,cat:e.target.value}))} className="field-input">{CATS.map(c=><option key={c}>{c}</option>)}</select></div>
            <div><label className="field-label">Status</label><select value={form.status} onChange={e=>setForm(f=>({...f,status:e.target.value}))} className="field-input">{STATUSES.map(st=><option key={st.v} value={st.v}>{st.label}</option>)}</select></div>
            <div><label className="field-label">Pre√ßo (R$)</label><input type="number" value={form.price} onChange={e=>setForm(f=>({...f,price:e.target.value}))} placeholder="89" className="field-input"/></div>
            <div><label className="field-label">Estoque Atual</label><input type="number" value={form.stock} onChange={e=>setForm(f=>({...f,stock:e.target.value}))} placeholder="10" className="field-input"/></div>
            <div className="col-full"><label className="field-label">Estoque M√°ximo (barra visual)</label><input type="number" value={form.maxStock} onChange={e=>setForm(f=>({...f,maxStock:e.target.value}))} placeholder="20" className="field-input"/></div>
            <div className="col-full"><label className="field-label" style={{marginBottom:10}}>üì∑ Foto do Produto</label><ImagePicker image={form.image} onChange={img=>setForm(f=>({...f,image:img}))}/></div>
          </div>
          <div style={{display:"flex",gap:10,marginTop:20}}>
            <button className="btn-primary" onClick={handleSave}>üíæ Salvar</button>
            <button className="btn-ghost" onClick={()=>{setShowForm(false);setEditing(null);}}>Cancelar</button>
          </div>
        </div>
      )}
      <div style={{position:"relative",marginBottom:12}}>
        <input value={search} onChange={e=>setSearch(e.target.value)} placeholder="Buscar produto..." className="field-input" style={{paddingLeft:36,marginBottom:0}}/>
        <span style={{position:"absolute",left:11,top:"50%",transform:"translateY(-50%)",opacity:.4,fontSize:14}}>üîç</span>
      </div>
      {filtered.length===0?<div className="empty"><span className="empty-icon">üì¶</span>Nenhum produto encontrado.</div>
        :filtered.map(p=>(
        <div key={p.id} className="product-row">
          <ThumbSm image={p.image} cat={p.cat}/>
          <div style={{flex:1,minWidth:0}}><div style={{fontWeight:700,fontSize:".95rem",lineHeight:1.2}}>{p.name}</div><div style={{fontFamily:"'Space Mono',monospace",fontSize:".58rem",color:"var(--muted)",marginTop:3}}>{p.cat}</div></div>
          <div style={{fontFamily:"'Bebas Neue',sans-serif",fontSize:"1.3rem",color:"var(--neon)",flexShrink:0}}>R${p.price}</div>
          <StatusBadge status={p.status}/>
          <div className="stock-controls">
            <button className="btn-stock" onClick={()=>adjustStock(p.id,-1)} disabled={p.stock===0}>‚àí</button>
            <div className="stock-val" style={{color:p.stock===0?"var(--accent)":p.stock<=2?"var(--gold)":"var(--text)"}}>{p.stock}</div>
            <button className="btn-stock" onClick={()=>adjustStock(p.id,1)}>+</button>
          </div>
          <div style={{display:"flex",gap:4,flexShrink:0}}>
            <button className="btn-sm" onClick={()=>openEdit(p)}>‚úèÔ∏è</button>
            <button className="btn-danger" onClick={()=>handleDelete(p.id)}>üóëÔ∏è</button>
          </div>
        </div>
      ))}
    </div>
  );
}

/* ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê
   RESERVAS ADMIN ‚Äî Firebase
‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê */
function ReservasAdmin({reservations,wishes,products,onToast}){
  const [filter,setFilter]=useState("pending");
  const sorted=[...reservations].filter(r=>filter==="all"||r.status===filter).sort((a,b)=>new Date(b.date)-new Date(a.date));
  const statusColors={pending:"var(--gold)",confirmed:"var(--green)",done:"var(--muted)",cancelled:"var(--accent)"};
  const statusLabels={pending:"‚è≥ Pendente",confirmed:"‚úÖ Confirmada",done:"‚úîÔ∏è Conclu√≠da",cancelled:"‚ùå Cancelada"};

  const updateStatus=async(id,status)=>{
    await fbUpdate("reservations",id,{status});
    const msgs={confirmed:"‚úÖ Reserva confirmada!",done:"‚úîÔ∏è Reserva conclu√≠da!",cancelled:"‚ùå Reserva cancelada."};
    onToast(msgs[status]||"Atualizado");
  };
  const openWA=(r)=>{
    const msg=`Ol√° ${r.name}! üëã A Multiverso confirma sua reserva de *${r.productName}*. Pode vir buscar! üéâ`;
    window.open(`https://wa.me/55${r.contact.replace(/\D/g,"")}?text=${encodeURIComponent(msg)}`,"_blank");
  };

  const wishesByProduct=useMemo(()=>{
    const map={};wishes.forEach(w=>{if(!map[w.productId]) map[w.productId]=[];map[w.productId].push(w);});return map;
  },[wishes]);
  const outProducts=products.filter(p=>(p.status==="out"||p.status==="pre")&&(wishesByProduct[p.id]||[]).length>0);

  return(
    <div>
      <div className="section-head">
        <div><div className="section-tag">// Admin</div><div className="section-title">Reservas & Espera</div></div>
        <div style={{fontFamily:"'Bebas Neue',sans-serif",fontSize:"1.8rem",color:"var(--gold)",letterSpacing:2}}>{reservations.filter(r=>r.status==="pending").length} pendentes</div>
      </div>
      <div style={{display:"flex",gap:6,marginBottom:16,flexWrap:"wrap"}}>
        {[["pending","‚è≥ Pendentes"],["confirmed","‚úÖ Confirmadas"],["done","‚úîÔ∏è Conclu√≠das"],["all","Todas"]].map(([v,l])=>(
          <button key={v} className={`nav-tab${filter===v?" active":""}`} onClick={()=>setFilter(v)} style={{fontSize:".58rem",padding:"6px 12px"}}>{l}</button>
        ))}
      </div>
      {sorted.length===0?<div className="empty"><span className="empty-icon">üõí</span>Nenhuma reserva nessa categoria.</div>
        :sorted.map(r=>(
        <div key={r.id} className="reservation-card" style={{borderLeftColor:statusColors[r.status]||"var(--gold)"}}>
          <div style={{display:"flex",alignItems:"flex-start",gap:14,flexWrap:"wrap"}}>
            <div style={{flex:1,minWidth:160}}>
              <div style={{display:"flex",alignItems:"center",gap:8,marginBottom:6,flexWrap:"wrap"}}>
                <span style={{fontWeight:700,fontSize:"1rem"}}>{r.name}</span>
                <span className="res-status" style={{color:statusColors[r.status],borderColor:statusColors[r.status]+"55"}}>{statusLabels[r.status]}</span>
              </div>
              <div style={{fontFamily:"'Space Mono',monospace",fontSize:".6rem",color:"var(--neon)",marginBottom:4}}>üì¶ {r.productName}</div>
              <div style={{fontFamily:"'Space Mono',monospace",fontSize:".6rem",color:r.contactType==="whatsapp"?"#4ade80":"var(--neon)"}}>{r.contactType==="whatsapp"?"üì±":"üìß"} {r.contact}</div>
              {r.note&&<div style={{fontSize:".82rem",color:"var(--muted)",marginTop:4}}>üí¨ {r.note}</div>}
              <div style={{fontFamily:"'Space Mono',monospace",fontSize:".55rem",color:"var(--muted)",marginTop:6}}>{fmtTime(r.date)}</div>
            </div>
            <div style={{display:"flex",flexDirection:"column",gap:6,flexShrink:0}}>
              {r.status==="pending"&&<>
                <button className="btn-neon" style={{fontSize:".58rem",padding:"7px 12px"}} onClick={()=>updateStatus(r.id,"confirmed")}>‚úÖ Confirmar</button>
                {r.contactType==="whatsapp"&&<button className="btn-whatsapp" onClick={()=>openWA(r)}>üí¨ WhatsApp</button>}
                <button className="btn-danger" onClick={()=>updateStatus(r.id,"cancelled")}>‚ùå Cancelar</button>
              </>}
              {r.status==="confirmed"&&<>
                <button className="btn-neon" style={{fontSize:".58rem",padding:"7px 12px"}} onClick={()=>updateStatus(r.id,"done")}>‚úîÔ∏è Conclu√≠da</button>
                {r.contactType==="whatsapp"&&<button className="btn-whatsapp" onClick={()=>openWA(r)}>üí¨ Avisar</button>}
              </>}
            </div>
          </div>
        </div>
      ))}
      {outProducts.length>0&&(
        <div style={{marginTop:36}}>
          <div style={{fontFamily:"'Space Mono',monospace",fontSize:".62rem",color:"var(--purple)",letterSpacing:3,marginBottom:16,textTransform:"uppercase"}}>‚ù§Ô∏è Lista de Espera por Produto</div>
          {outProducts.map(p=>{const ws=wishesByProduct[p.id]||[];return(
            <div key={p.id} style={{background:"var(--panel)",border:"1px solid var(--border)",borderLeft:"3px solid var(--purple)",padding:"14px 18px",marginBottom:2}}>
              <div style={{display:"flex",alignItems:"center",gap:12,marginBottom:12}}>
                <ThumbSm image={p.image} cat={p.cat}/>
                <div style={{flex:1}}><div style={{fontWeight:700}}>{p.name}</div><div style={{fontFamily:"'Space Mono',monospace",fontSize:".6rem",color:"var(--muted)"}}>{p.cat}</div></div>
                <span style={{fontFamily:"'Bebas Neue',sans-serif",fontSize:"1.5rem",color:"var(--purple)"}}>{ws.length} ‚ù§Ô∏è</span>
              </div>
              {ws.map(w=>(
                <div key={w.id} style={{display:"flex",alignItems:"center",gap:10,padding:"8px 0",borderTop:"1px solid var(--border)",flexWrap:"wrap"}}>
                  <span style={{fontSize:"1rem"}}>{w.contactType==="whatsapp"?"üì±":"üìß"}</span>
                  <div style={{flex:1,minWidth:120}}><span style={{fontWeight:600}}>{w.name}</span> <span style={{fontFamily:"'Space Mono',monospace",fontSize:".6rem",color:"var(--neon)"}}>{w.contact}</span></div>
                  {w.contactType==="whatsapp"&&(
                    <button className="btn-whatsapp" style={{fontSize:".65rem",padding:"5px 10px"}} onClick={()=>{
                      const msg=`Ol√° ${w.name}! üëã O produto *${p.name}* que voc√™ estava esperando chegou na Multiverso! üéâ Corre antes de esgotar!`;
                      window.open(`https://wa.me/55${w.contact.replace(/\D/g,"")}?text=${encodeURIComponent(msg)}`,"_blank");
                    }}>üí¨ Avisar</button>
                  )}
                </div>
              ))}
            </div>
          );})}
        </div>
      )}
    </div>
  );
}

/* ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê
   LAUNCHES ADMIN ‚Äî Firebase
‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê */
function LaunchesAdmin({launches,onToast,onAddLog}){
  const [form,setForm]=useState({name:"",date:"",type:"Mang√°",note:""}),[showForm,setShowForm]=useState(false),[search,setSearch]=useState("");
  const sorted=[...launches].sort((a,b)=>new Date(a.date)-new Date(b.date)).filter(l=>l.name.toLowerCase().includes(search.toLowerCase())||l.type.toLowerCase().includes(search.toLowerCase()));
  const handleAdd=async()=>{
    if(!form.name||!form.date) return;
    const id=uid();
    await fbAdd("launches",{id,...form});
    setForm({name:"",date:"",type:"Mang√°",note:""});setShowForm(false);
    onToast("‚úÖ Lan√ßamento adicionado!");onAddLog(`Novo lan√ßamento: ${form.name}`,"lancamento");
  };
  const del=async id=>{
    const l=launches.find(x=>x.id===id);
    await fbDelete("launches",id);
    onToast("üóëÔ∏è Lan√ßamento removido.");onAddLog(`Lan√ßamento removido: ${l?.name||id}`,"lancamento");
  };
  return(
    <div>
      <div className="section-head">
        <div><div className="section-tag">// Admin</div><div className="section-title">Lan√ßamentos</div></div>
        <button className="btn-primary" onClick={()=>setShowForm(!showForm)}>+ Novo Lan√ßamento</button>
      </div>
      {showForm&&(
        <div className="form-panel">
          <div className="form-title">üìÖ NOVO LAN√áAMENTO</div>
          <div className="form-grid">
            <div className="col-full"><label className="field-label">Nome</label><input value={form.name} onChange={e=>setForm(f=>({...f,name:e.target.value}))} placeholder="Ex: One Piece Vol. 108" className="field-input"/></div>
            <div><label className="field-label">Data</label><input type="date" value={form.date} onChange={e=>setForm(f=>({...f,date:e.target.value}))} className="field-input"/></div>
            <div><label className="field-label">Tipo</label><select value={form.type} onChange={e=>setForm(f=>({...f,type:e.target.value}))} className="field-input">{CATS.map(c=><option key={c}>{c}</option>)}</select></div>
            <div className="col-full"><label className="field-label">Observa√ß√£o (opcional)</label><input value={form.note} onChange={e=>setForm(f=>({...f,note:e.target.value}))} placeholder="Ex: Ed. limitada..." className="field-input"/></div>
          </div>
          <div style={{display:"flex",gap:10,marginTop:16}}>
            <button className="btn-primary" onClick={handleAdd}>üíæ Adicionar</button>
            <button className="btn-ghost" onClick={()=>setShowForm(false)}>Cancelar</button>
          </div>
        </div>
      )}
      <div style={{position:"relative",marginBottom:12}}>
        <input value={search} onChange={e=>setSearch(e.target.value)} placeholder="Buscar lan√ßamento..." className="field-input" style={{paddingLeft:36,marginBottom:0}}/>
        <span style={{position:"absolute",left:11,top:"50%",transform:"translateY(-50%)",opacity:.4,fontSize:14}}>üîç</span>
      </div>
      {sorted.length===0?<div className="empty"><span className="empty-icon">üóìÔ∏è</span>Nenhum lan√ßamento encontrado.</div>
        :sorted.map(l=>{const d=new Date(l.date+"T00:00:00");return(
        <div key={l.id} style={{background:"var(--panel)",border:"1px solid var(--border)",borderLeft:"3px solid var(--accent)",padding:"14px 18px",marginBottom:2,display:"flex",alignItems:"center",gap:18,transition:"background .2s"}}
          onMouseEnter={e=>{e.currentTarget.style.background="var(--card)"}} onMouseLeave={e=>{e.currentTarget.style.background="var(--panel)"}}>
          <div style={{textAlign:"center",minWidth:48}}>
            <div style={{fontFamily:"'Bebas Neue',sans-serif",fontSize:"2.2rem",color:"var(--accent)",lineHeight:1}}>{d.getDate()}</div>
            <div style={{fontFamily:"'Space Mono',monospace",fontSize:".55rem",color:"var(--muted)",letterSpacing:2}}>{d.toLocaleString("pt-BR",{month:"short"}).toUpperCase()}</div>
          </div>
          <div style={{width:1,height:44,background:"var(--border)"}}/>
          <div style={{flex:1,minWidth:0}}>
            <div style={{fontFamily:"'Space Mono',monospace",fontSize:".58rem",color:TYPE_COLOR[l.type]||"var(--neon)",letterSpacing:2,marginBottom:3,textTransform:"uppercase"}}>{l.type}</div>
            <div style={{fontWeight:700}}>{l.name}</div>
            {l.note&&<div style={{fontSize:".8rem",color:"var(--muted)"}}>{l.note}</div>}
          </div>
          <button className="btn-danger" onClick={()=>del(l.id)}>üóëÔ∏è</button>
        </div>
      );})}
    </div>
  );
}

/* ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê
   SUBSCRIBERS ADMIN
‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê */
function SubscribersAdmin({subscribers}){
  const [filter,setFilter]=useState("todos");
  const filtered=subscribers.filter(s=>filter==="todos"||s.contactType===filter);
  const waNums=subscribers.filter(s=>s.contactType==="whatsapp").map(s=>s.contact);
  const emails=subscribers.filter(s=>s.contactType==="email").map(s=>s.contact);
  const openWAAll=()=>{
    const msg=`Ol√°! üëã A Multiverso tem novidades incr√≠veis esperando por voc√™! Venha nos visitar ou acesse nosso cat√°logo online. üéâ`;
    window.open(`https://wa.me/?text=${encodeURIComponent(msg)}`,"_blank");
  };
  return(
    <div>
      <div className="section-head">
        <div><div className="section-tag">// Admin</div><div className="section-title">Notifica√ß√µes</div></div>
        <div style={{fontFamily:"'Bebas Neue',sans-serif",fontSize:"1.8rem",color:"var(--accent)",letterSpacing:2}}>{subscribers.length} cadastros</div>
      </div>
      <div style={{display:"flex",gap:6,marginBottom:16,flexWrap:"wrap"}}>
        {["todos","whatsapp","email"].map(f=>(
          <button key={f} className={`nav-tab${filter===f?" active":""}`} onClick={()=>setFilter(f)} style={{fontSize:".6rem",padding:"7px 16px"}}>
            {f==="todos"?"Todos":f==="whatsapp"?"üì± WhatsApp":"üìß E-mail"}
          </button>
        ))}
      </div>
      {filtered.length===0?<div className="empty"><span className="empty-icon">üîî</span>Nenhum cadastro ainda.</div>
        :filtered.map(sub=>(
        <div key={sub.id} className="sub-row">
          <span style={{fontSize:"1.5rem"}}>{sub.contactType==="whatsapp"?"üì±":"üìß"}</span>
          <div style={{flex:1,minWidth:0}}>
            <div style={{fontWeight:700,fontSize:".95rem"}}>{sub.name}</div>
            <div style={{fontFamily:"'Space Mono',monospace",fontSize:".62rem",color:"var(--neon)",marginTop:2}}>{sub.contact}</div>
            {sub.interest&&<div style={{fontSize:".82rem",color:"var(--muted)",marginTop:3}}>üí¨ {sub.interest}</div>}
          </div>
          <div style={{fontFamily:"'Space Mono',monospace",fontSize:".58rem",color:"var(--muted)",textAlign:"right",flexShrink:0}}>{fmtDate(sub.date)}</div>
        </div>
      ))}
      {subscribers.length>0&&(
        <div style={{marginTop:24,background:"var(--panel)",border:"1px solid var(--border)",borderLeft:"3px solid var(--neon)",padding:"20px"}}>
          <div style={{fontFamily:"'Space Mono',monospace",fontSize:".62rem",color:"var(--neon)",letterSpacing:2,marginBottom:12}}>üí° NOTIFICAR EM MASSA</div>
          <button className="btn-whatsapp" onClick={openWAAll} style={{marginBottom:16}}>üí¨ Mensagem WhatsApp Gen√©rica</button>
          <p style={{fontSize:".9rem",color:"var(--muted)",lineHeight:1.7,marginBottom:12}}>Ou copie os contatos abaixo:</p>
          {waNums.length>0&&<><div style={{fontFamily:"'Space Mono',monospace",fontSize:".58rem",color:"var(--muted)",letterSpacing:2,marginBottom:6}}>üì± WHATSAPP</div><div className="contacts-box">{waNums.join("\n")}</div></>}
          {emails.length>0&&<><div style={{fontFamily:"'Space Mono',monospace",fontSize:".58rem",color:"var(--muted)",letterSpacing:2,marginBottom:6,marginTop:14}}>üìß E-MAILS</div><div className="contacts-box">{emails.join("\n")}</div></>}
        </div>
      )}
    </div>
  );
}

/* ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê
   RELAT√ìRIO
‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê */
function Relatorio({products,subscribers,reservations,wishes}){
  const catCount=useMemo(()=>{
    const m={};
    subscribers.forEach(s=>{if(!s.interest) return;CATS.forEach(c=>{if(s.interest.toLowerCase().includes(c.toLowerCase())) m[c]=(m[c]||0)+1;});});
    wishes.forEach(w=>{const p=products.find(x=>x.id===w.productId);if(p) m[p.cat]=(m[p.cat]||0)+1;});
    reservations.forEach(r=>{if(r.productCat) m[r.productCat]=(m[r.productCat]||0)+1;});
    return Object.entries(m).sort((a,b)=>b[1]-a[1]);
  },[subscribers,wishes,reservations,products]);

  const topWished=useMemo(()=>{
    const m={};wishes.forEach(w=>{m[w.productId]=(m[w.productId]||0)+1;});
    return Object.entries(m).sort((a,b)=>b[1]-a[1]).slice(0,5).map(([id,count])=>{const p=products.find(x=>x.id===id);return{id,name:p?p.name:"Produto removido",count};});
  },[wishes,products]);

  const topReserved=useMemo(()=>{
    const m={};reservations.forEach(r=>{m[r.productId]=(m[r.productId]||0)+1;});
    return Object.entries(m).sort((a,b)=>b[1]-a[1]).slice(0,5).map(([id,count])=>{const p=products.find(x=>x.id===id);return{id,name:p?p.name:reservations.find(r=>r.productId===id)?.productName||"?",count};});
  },[reservations,products]);

  const maxCat=catCount.length>0?catCount[0][1]:1;
  const maxWish=topWished.length>0?topWished[0].count:1;
  const maxRes=topReserved.length>0?topReserved[0].count:1;
  const catColors=["var(--neon)","var(--accent)","var(--gold)","var(--purple)","var(--orange)","var(--green)","#5b9aff"];

  return(
    <div>
      <div className="section-head"><div><div className="section-tag">// An√°lise</div><div className="section-title">Relat√≥rio de Interesse</div></div></div>
      <div style={{display:"grid",gridTemplateColumns:"1fr 1fr",gap:16,marginBottom:32}}>
        {[{num:subscribers.length,label:"Total de Cadastros",color:"var(--neon)"},{num:reservations.length,label:"Total de Reservas",color:"var(--gold)"},{num:wishes.length,label:"Listas de Espera",color:"var(--purple)"},{num:reservations.filter(r=>r.status==="done").length,label:"Reservas Conclu√≠das",color:"var(--green)"}].map((st,i)=>(
          <div key={i} style={{background:"var(--panel)",border:"1px solid var(--border)",padding:"20px"}}>
            <div className="stat-num" style={{color:st.color}}>{st.num}</div>
            <div className="stat-label">{st.label}</div>
          </div>
        ))}
      </div>
      {catCount.length>0&&(
        <div style={{background:"var(--panel)",border:"1px solid var(--border)",padding:"24px",marginBottom:16}}>
          <div style={{fontFamily:"'Space Mono',monospace",fontSize:".62rem",color:"var(--neon)",letterSpacing:3,marginBottom:20,textTransform:"uppercase"}}>üìä Interesse por Categoria</div>
          {catCount.map(([cat,count],i)=>(
            <div key={cat} className="report-bar-row">
              <div className="report-label">{cat}</div>
              <div className="report-bar-bg"><div className="report-bar-fill" style={{width:(count/maxCat*100)+"%",background:catColors[i%catColors.length]}}/></div>
              <div className="report-count">{count}</div>
            </div>
          ))}
        </div>
      )}
      <div style={{display:"grid",gridTemplateColumns:"1fr 1fr",gap:16}}>
        {topWished.length>0&&(<div style={{background:"var(--panel)",border:"1px solid var(--border)",padding:"24px"}}>
          <div style={{fontFamily:"'Space Mono',monospace",fontSize:".62rem",color:"var(--purple)",letterSpacing:3,marginBottom:16,textTransform:"uppercase"}}>‚ù§Ô∏è Mais Desejados</div>
          {topWished.map(item=>(
            <div key={item.id} className="report-bar-row">
              <div className="report-label" style={{fontSize:".58rem",minWidth:0,flex:1,overflow:"hidden",textOverflow:"ellipsis",whiteSpace:"nowrap"}}>{item.name}</div>
              <div className="report-bar-bg" style={{minWidth:60}}><div className="report-bar-fill" style={{width:(item.count/maxWish*100)+"%",background:"var(--purple)"}}/></div>
              <div className="report-count">{item.count}</div>
            </div>
          ))}
        </div>)}
        {topReserved.length>0&&(<div style={{background:"var(--panel)",border:"1px solid var(--border)",padding:"24px"}}>
          <div style={{fontFamily:"'Space Mono',monospace",fontSize:".62rem",color:"var(--gold)",letterSpacing:3,marginBottom:16,textTransform:"uppercase"}}>üõí Mais Reservados</div>
          {topReserved.map(item=>(
            <div key={item.id} className="report-bar-row">
              <div className="report-label" style={{fontSize:".58rem",minWidth:0,flex:1,overflow:"hidden",textOverflow:"ellipsis",whiteSpace:"nowrap"}}>{item.name}</div>
              <div className="report-bar-bg" style={{minWidth:60}}><div className="report-bar-fill" style={{width:(item.count/maxRes*100)+"%",background:"var(--gold)"}}/></div>
              <div className="report-count">{item.count}</div>
            </div>
          ))}
        </div>)}
      </div>
      {catCount.length===0&&topWished.length===0&&topReserved.length===0&&(
        <div className="empty"><span className="empty-icon">üìà</span>Nenhum dado ainda.<br/>Os relat√≥rios aparecem conforme os clientes interagem.</div>
      )}
    </div>
  );
}

/* ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê
   APP ROOT ‚Äî Firebase listeners
‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê */
function App(){
  const [view,setView]=useState("customer"),[isAuth,setIsAuth]=useState(false);
  const [theme,setTheme]=useState(()=>{try{return localStorage.getItem("mv-theme")||"dark"}catch{return "dark"}});
  const [loading,setLoading]=useState(true),[synced,setSynced]=useState(true);
  const [products,setProducts]=useState([]);
  const [launches,setLaunches]=useState([]);
  const [subscribers,setSubscribers]=useState([]);
  const [reservations,setReservations]=useState([]);
  const [wishes,setWishes]=useState([]);
  const [activityLog,setActivityLog]=useState([]);
  const [toasts,setToasts]=useState([]);
  const loadedRef=useRef(0);

  const checkAllLoaded=()=>{
    loadedRef.current+=1;
    if(loadedRef.current>=6) setLoading(false);
  };

  useEffect(()=>{
    const unsubs=[];

    // Products
    unsubs.push(col("products").onSnapshot(snap=>{
      const data=snap.docs.map(d=>d.data());
      if(snap.docs.length===0&&loadedRef.current===0){
        INIT_PRODUCTS.forEach(p=>fbAdd("products",p));
      }
      setProducts(data);setSynced(true);checkAllLoaded();
    },()=>setSynced(false)));

    // Launches
    unsubs.push(col("launches").onSnapshot(snap=>{
      const data=snap.docs.map(d=>d.data());
      if(snap.docs.length===0&&loadedRef.current===0){
        INIT_LAUNCHES.forEach(l=>fbAdd("launches",l));
      }
      setLaunches(data);checkAllLoaded();
    }));

    // Subscribers
    unsubs.push(col("subscribers").onSnapshot(snap=>{
      setSubscribers(snap.docs.map(d=>d.data()));checkAllLoaded();
    }));

    // Reservations
    unsubs.push(col("reservations").onSnapshot(snap=>{
      setReservations(snap.docs.map(d=>d.data()));checkAllLoaded();
    }));

    // Wishes
    unsubs.push(col("wishes").onSnapshot(snap=>{
      setWishes(snap.docs.map(d=>d.data()));checkAllLoaded();
    }));

    // Activity Log (ordered by date desc, limit 50)
    unsubs.push(col("activityLog").orderBy("date","desc").limit(50).onSnapshot(snap=>{
      setActivityLog(snap.docs.map(d=>d.data()));checkAllLoaded();
    }));

    return()=>unsubs.forEach(u=>u());
  },[]);

  const showToast=(msg,color="#4ade80")=>setToasts(t=>[...t,{id:uid(),msg,color}]);
  const removeToast=id=>setToasts(t=>t.filter(x=>x.id!==id));

  const addLog=useCallback(async(msg,type="sistema")=>{
    const entry={id:uid(),msg,type,date:new Date().toISOString()};
    await fbAdd("activityLog",entry);
  },[]);

  const addSubscriber=useCallback(async sub=>{
    await fbAdd("subscribers",sub);
    await addLog(`Novo cadastro: ${sub.name} (${sub.contactType})`,"cadastro");
    showToast("‚úÖ Cadastro realizado!");
  },[]);

  const addReservation=useCallback(async r=>{
    await fbAdd("reservations",r);
    await addLog(`Nova reserva: ${r.name} ‚Äî ${r.productName}`,"reserva");
    showToast("üõí Reserva enviada!");
  },[]);

  const addWish=useCallback(async w=>{
    await fbAdd("wishes",w);
    await addLog(`Lista de espera: ${w.name} ‚Äî ${w.productName}`,"cadastro");
    showToast("‚ù§Ô∏è Adicionado √† lista de espera!");
  },[]);

  // Se Firebase n√£o configurado, mostra tela de setup em vez de tela preta
  if (!FB_CONFIGURED) return <SetupScreen/>;

  if(loading){
    return(
      <div className="loading-screen">
        <div style={{fontFamily:"'Bebas Neue',sans-serif",fontSize:"2rem",letterSpacing:4,background:"linear-gradient(135deg,var(--neon),var(--accent))",WebkitBackgroundClip:"text",WebkitTextFillColor:"transparent",backgroundClip:"text"}}>MULTIVERSO</div>
        <div className="spinner"/>
        <div style={{fontFamily:"'Space Mono',monospace",fontSize:".65rem",color:"var(--muted)",letterSpacing:3}}>Conectando ao banco de dados...</div>
      </div>
    );
  }

  return(
    <div style={{fontFamily:"'Rajdhani',sans-serif",background:"var(--void)",color:"var(--text)",minHeight:"100vh",overflowX:"hidden"}}>
      <nav className="nav">
        <div className="logo" onClick={()=>setView("customer")}>MULTI<span className="logo-gold">VERSO</span></div>
        <div style={{display:"flex",gap:6,alignItems:"center"}}>
          <ThemePicker theme={theme} setTheme={setTheme}/>
          <button className={`nav-tab${view==="customer"?" active":""}`} onClick={()=>setView("customer")}>üè† Loja</button>
          {!isAuth
            ?<button className={`nav-tab${view==="adminLogin"?" active":""}`} onClick={()=>setView("adminLogin")}>üîí Admin</button>
            :<button className={`nav-tab${view==="admin"?" active":""}`} onClick={()=>setView("admin")}>‚öôÔ∏è Painel</button>
          }
        </div>
      </nav>

      {view==="customer"   && <CustomerPage products={products} launches={launches} reservations={reservations} wishes={wishes} onReserve={addReservation} onWish={addWish} onNotifySignup={addSubscriber}/>}
      {view==="adminLogin" && !isAuth && <AdminLogin onLogin={()=>{setIsAuth(true);setView("admin");addLog("Login no painel admin","sistema");}}/>}
      {view==="admin"      && isAuth  && (
        <AdminPanel
          products={products} launches={launches} subscribers={subscribers}
          reservations={reservations} wishes={wishes} activityLog={activityLog}
          synced={synced}
          onLogout={()=>{setIsAuth(false);setView("customer");}}
          onToast={showToast} onAddLog={addLog}
        />
      )}
      {toasts.map(t=><Toast key={t.id} msg={t.msg} color={t.color} onClose={()=>removeToast(t.id)}/>)}
    </div>
  );
}

ReactDOM.createRoot(document.getElementById("root")).render(<App/>);
</script>
</body>
</html>
